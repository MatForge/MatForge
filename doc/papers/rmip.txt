RMIP: 
Displacementray-tracingviainversionandoblongbounding 


ThÃ©oThonat 
thonat@adobe.com 
IliyanGeorgiev 
igeorgiev@adobe.com 
FranÃ§oisBeaune 
beaune@adobe.com 
TamyBoubekeur 
boubek@adobe.com 
Adobe 
Adobe 
Adobe 
Adobe 
France 
UK 
France 
France 



Figure1:Ascenewheremostgeometriccontentcomesfromhigh-resolutiondisplacementmapping.Thebasegeometryand 
the4kdisplacementmapstiledonitareshownontheright.Ourproposedmethodachieves11Ã—fasterpathtracingthan 
TFDM[Thonatetal.2021]whileconsuming3Ã—lessmemory. 


ABSTRACT 


High-performanceraytracingoftrianglemeshesequippedwith 
displacementmapsisachallengingtask.Existingmethodseither 
relyonpre-tessellation,takingfulladvantageofthehardwarebut 
withapoormemory/qualitytradeoff,orusecustomdisplacementcentricaccelerationstructures,
preservingallthegeometricdetails 
butbeingordersofmagnitudeslower.Weintroduceamethodthat 
efficientlyprobesthedisplacement-mapspacetofindray-surface 
intersectionswithoutrelyingonpre-tessellation.Ourmethodcombinesinversedisplacementmappingandon-
the-flysurface-bound 
computation.Itemploysanoveldatastructurethatprovidestight 
displacementboundsoverrectangularregionsinthedisplacementmapspace.
Wedemonstratetheeffectivenessofourapproachina 
productionGPUpathtracer.Itcanachieveoveranorderofmagnitudespeed-
upinrendertimecomparedtostateoftheartinthemost 
challengingreal-timepath-tracingscenarios,whilemaintaininga 
lowmemoryfootprint. 


Permissiontomakedigitalorhardcopiesofpartorallofthisworkforpersonalor 
classroomuseisgrantedwithoutfeeprovidedthatcopiesarenotmadeordistributed 
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation 
onthefirstpage.Copyrightsforthird-partycomponentsofthisworkmustbehonored. 
Forallotheruses,contacttheowner/author(s). 


SAConferencePapersâ€™23,December12â€“15,2023,Sydney,NSW,Australia 


Â©2023Copyrightheldbytheowner/author(s). 
ACMISBN979-8-4007-0315-7/23/12. 
https://doi.org/10.1145/3610548.3618182 


CCSCONCEPTS 
â€¢Computingmethodologiesâ†’Rendering. 


KEYWORDS 


GPURayTracing,DisplacementMapping 


ACMReferenceFormat: 


ThÃ©oThonat,IliyanGeorgiev,FranÃ§oisBeaune,andTamyBoubekeur.2023. 
RMIP:Displacementray-tracingviainversionandoblongbounding.In 


SIGGRAPHAsia2023ConferencePapers(SAConferencePapersâ€™23),December 
12â€“15,2023,Sydney,NSW,Australia.ACM,NewYork,NY,USA,11pages. 
https://doi.org/10.1145/3610548.3618182 


1 
INTRODUCTION 


Displacementmappingisapowerfulmechanismtoenrichbase 
3Dmesheswithhigh-frequencydetailsandmesostructures,offloadingmostoftheresultingrepresentationtoa(
commonlyhighresolution)
2Dmapproviding,foranypointofthesurface,adisplacementvalue.
Atrenderingtime,thebasegeometryisdeformed 
accordingtothemap,torecoverthefull-resolutionshape.Assuch, 
largepartsoftheshapeprocessingandmanagementcanbeperformedonthelow-
resolutionbasesurface,leveragingtherandomaccessiblenatureofthedisplacementmaptoprovideeasylevelof 
detail,compression,andfiltering.Inpractice,real-timedisplacementmappingisoftenmadeavailablethroughrasterizationengines, 



SAConferencePapersâ€™23,December12â€“15,2023,Sydney,NSW,Australia 


wherehardwaretessellationtriggersthedisplacementprocessat 
everyframe.Unfortunately,forreal-timeraytracing,displacement 
mappingistypicallyappliedasapreprocess,producingahighresolutionmeshtobemaintainedduringrenderingwhichstill 
suffersfromsubsamplingartifactsinreal-worldscenarios. 


ModernGPUarchitecturesofferhardwaresupportforraytracing[
Sanzharovetal.2020],whichenablesinteractivephysicallybasedrenderingbasedonMonteCarlointegration,
inanaimto 
bridgethegapbetweenreal-timeandofflinerendering.Primarily 
designedfortrianglemeshes,thisnewprogrammableGPUpipeline 
drawsitsefficiencyfromanunderlyingaccelerationstructure(AS), 
organizedinatop-levelcomponent(TLAS)andabottomlevel 
one(BLAS).However,suchboundingvolumehierarchiesrequire 
explicitrealizationofthehigh-resolutiongeometry,i.e.,aftertessellationanddisplacement,
whichquicklyfailsatreproducingaccuratelycomplexdisplacementmapsoverarbitrarymacrodomains, 
entailsalargememoryfootprint,isintractablewhenthedisplacementcontentisdynamic,
andmayultimatelynotbepossiblewhen 
tilingthedisplacementoverthedomain. 


Tessellation-freedisplacementmapping(TFDM)hasbeenrecentlyproposedasanalternativetoexplicitdisplacementmeshing[
Thonatetal.2021].Itachievesfullaccuracybutexhibitslimited 
executionperformance.Wetacklethisproblembyintroducinga 
newdatastructure,dubbedRMIP,whichallowstoquicklydiscover 
thedisplacementmapsubregionsthatarelikelytointersectaray. 
Itsupportssubregionswithrectangularshape,enablingthepropagationoftightboundsbetweenthe2Ddisplacementspaceandthe 
3Drayspace,toquicklynarrowdownthesearchforintersectionin 
afront-to-backmanner.Byoftenreducingthenumberoftraversal 
stepsbyoveranorderofmagnitude,ourmethodcanachievea 
speed-upof10Ã—ormoreoverTFDM,whilepreservingfullaccuracy(
seeFig.1)andremainingorthogonaltoboththehardware 
TLAS/BLAStraversalandthefinalray-surfaceintersectiontest. 


2 
PREVIOUSWORK 


Ray-traceddisplacementmaps.Offlinerenderingofsceneswith 
complexgeometrysparkedmanyextensionsoftheReyesarchitecture,
drivenbycachingandrayreordering[Christensenetal. 
2003].Lazybuildingoflocalaccelerationsstructureswasexplored 
byHuntetal.[2007].Hanikaetal.[2010]extendedittotwo-level 
accelerationstructures,wherethelowerlevelsarepopulatedby 
structuresresultingfromon-demandsurfacetessellation.Asimilar 
schemehasbeenusedinthecontextofvectordisplacementmapping[
Harada2015].Performanceinthesesetupscriticallydepends 
onrayreorderingtomaximizethereuseofthelocalstructures. 
Incontrast,weuseanimplicitaccelerationstructureuniqueto 
eachray,generatingthemicro-structureonlyatthescaleofthe 
displacementtexels,thusfreeofrayreorderingconstraints. 


TheRazorsystem[Djeuetal.2011]allowseachraytoindependentlychooseitsappropriategeometricresolution.
Itreliesonlazy 
evaluationandcachingoflocaltessellationsatdiscretelevelsof 
detail(LoDs)thatareinterpolatedatintersectiontimetogenerate 
fractionalLoDs.Ourper-raytraversalstructureallowsintersecting 
thedisplacedsurfacedirectlyatfractionalLoDs,sincewegenerate 
thesurfaceexplicitlyonlyduringthefinalstepsofthetraversal. 


ThÃ©oThonat,IliyanGeorgiev,FranÃ§oisBeaune,andTamyBoubekeur 


Real-timedisplacementmapping.Inthecontextofrasterization, 
numerousmethodshavebeenproposedtorendersurfacedetails 
inrealtimewithouttessellation.Inparticular,probingaheight 
maptofindapproximateintersectionswiththemeso-surfacehas 
beenextensivelystudied.Parallaxmapping[Kanekoetal.2001; 
Tatarchuk2006]offsetstheintersectionintexturespacebasedon 
theheightcontent.Samplingtheheightfieldusingray-marching 
allowsfindingapairofpointsaboveandbelowthesurface,whichis 
thestartingpointforseveralrefinementmethods,forexampleusing 
thesecantmethod[YerexandJÃ¤gersand2004],usingbinarysearch 
withreliefmapping[Policarpoetal.2005],orusingaminmax 
texture[Leeetal.2009].Heightmapscanalsobepre-processedto 
encodeemptyspacenearthesurface,allowingtosafelyray-march 
withadaptivesteps.Numeroussafetyshapeshasbeenproposed, 
suchasspheres[Hart1996;Donnelly2005],cones[Dummer2006; 
PolicarpoandOliveira2007],andcylinders[Baboudetal.2011]. 
Anin-depthoverviewofmeso-surfacereal-timerenderingcanbe 
foundinthesurveyofSzirmay-Kalosetal.[2009].Allthosemethods 
approximatethetangentspacebyalocallyflatheightfield.This 
makestherenderedsurfaceview-dependentwhenthebasesurface 
hascurvature,makingthosemethodsunsuitableforourraytracing 
context. 


Anothertypeofapproachesconsistsinpre-computingintersectionswiththemeso-
surfacefromadensesamplingofqueryrays 
andcompressingtheminasuitablewayforrealtimerendering. 
Earlymethodsrelyonsingularvaluedecomposition[Wangetal. 
2003,2004];recentworksuseasmallsetofneuralnetswithspatially 
variantweights,storedintextures,andmappedontoabounding 
volume[Kuznetsovetal.2021,2022].Althoughsuchmethodshandleavarietyofmeso-
geometriesbeyondscalardisplacement,their 
encodingrequiresexpensivepre-processing,withrenderingquality 
proportionaltothememoryconsumption.Incontrast,ourmethod 
requiresminimalpre-processingandstorage,whilepreservingthe 
fullgeometricandvisualcomplexityofthedisplacementcontent. 


Inversemappings.Mappingthevicinityofa3Dsurfaceback 
toitstexturespaceallowstransformingraytracingofcomplex, 
possiblyvolumetric,meso-structurestosimpler2Dtracing.Inthe 
contextofshellmapping,Porumbescuetal.[2005]createathinvolumetriclayeraroundthesurfacebyextrudingthemeshoutwardin 
thenormaldirections.Raysintersectingthisvolumecanbemapped 
totexturespace,wheretraditionalreal-timeheight-field-marching 
techniquescanbeapplied,althoughinheritingtheirshortcomings. 
Sincethemappingfromworldtotexturespaceisnon-linear,special 
careisrequiredtohandlethetracingofcurvedraypathstoavoid 
missingintersectionsfromtheheightfield[Jeschkeetal.2007]. 
Inthecontextofdisplacementmapping,Pattersonetal.[1991] 
projectintersectionsbetweentherayandaboundingvolumeback 
totexturespacefollowingthedirectionsofdisplacement.They 
usetheseprojectedintersectionstoconservativelytracktheray 
intexturespacewhichgreatlyreducesthesearchregionforintersection.
Theirmethod,anditsextension[LogieandPatterson 
1995],islimitedtoanumberofanalyticalbasesurfaces;weutilize 
thismappingandextendinversedisplacementmappingtotriangle 
meshes. 


Implicitaccelerationstructuresforraytracing.Thememoryburdenofacceleratingtheraytracingofhighlydetailedgeometryhas 



RMIP:Displacementray-tracingviainversionandoblongbounding 
SAConferencePapersâ€™23,December12â€“15,2023,Sydney,NSW,Australia 



Figure2:Overviewofourmethod.(a)Theinputisatrianglemeshandadisplacementmap.(b)Wefirstpre-processthemap 
intoournovelRMIPdatastructurethatstoresminmaxdisplacementboundsoverrectangularregionsintexturespace.(c)Once 
thedisplacementismappedontothetrianglemeshaccordingtothedisplacementparameters,atightboundingprismforthe 
displacedsurfacewithineachbasetriangleiscomputed,andallprismsareorganizedintoastaticboundingvolumehierarchy. 
(d)Atray-tracingtime,anyintersectionbetweenarayandaboundingprismtriggersourcustomtraversal,whichping-pongs 
between2Drayboundsintexturespaceand3Ddisplacementboundsinobjectspacetotightentheintervalofpotential 
intersectioninahierarchicalfashion(seeFig.3).Oncethe2Dboundsaresmallenough,weswitchtoatexel-marchingprocess, 
generatingandintersectingmicro-geometryon-the-flyalongtheray. 


leadtothedevelopmentofimplicitaccelerationstructures.Similarlytoourwork,
HeidrichandSeidel[1998]useaffinearithmetic 
toestimate3Dboundsinthecontextofproceduralshaderswith 
analyticalbasesurfacesanddisplacement.TheworkofSmitsetal. 
[2000]allowsraytracingofdisplacedtrianglemesheswithouttessellation,
marchingthroughboundingprismsdefinedfromthebase 
trianglebarycentricspace.Wealsouseboundingprismsandlinear 
marching,althoughweapplythemonlyatspecificstepsofour 
traversal.Boundingprismsandbarycentricgridswerealsoused 
byMaggiordomoetal.[2023]toefficientlycompressdisplacement 
content,inawaythatcanberay-tracedwithhardwaresupport 
withoutpre-tessellation.Inourcase,basetrianglesgenerallydo 
notcoincidewithfacesoftheboundingprisms(seeFig.2). 


Carretal.[2006]useminmaxmipmapstoefficientlyray-trace 
geometryimages,buildinganimplicitquad-treeboundingvolume 
hierarchyinğ‘¢ğ‘£ 
space.Similarly,theworkofOhetal.[2006],laterimprovedbyTevsetal.[
2008],useamaximumdisplacementmipmap 
asanimplicithierarchicaldatastructure,restrictedtoheightfields 
onplanarsurfaces. 


Mostrelevanttoourworkisthetessellation-freedisplacement 
mapping(TFDM)methodofThonatetal.[2021].Theyuseaminmax 
mipmapbothtolocallyboundthedisplacementandasanaccelerationstructureforraytraversalintexturespace.
Displaced-surface 
boundsaregeneratedon-the-flyfromthequad-treenodesusing 
affinearithmeticandtestedagainsttheray.Analyticray-surface 
intersectionisperformeduponreachingatexel-sizednode.TFDM 
supportsfractionalLoDanddisplacementtiling,andachievesgreat 
pre-computationandmemorysavings.Unfortunately,thesesavingscomeatthecostofsubstantialcomputationalburdenduring 
renderingduetolooseboundsandinefficientspacecullingleading 
tolongtraversals.Ourworkaddressestheseshortcomingstosignificantlyimproveperformancewithoutsacrificingthebenefitsof 
TFDM. 


3 
OURMETHOD 


Weproposeamethodfordirectraytracingagainstatrianglemesh 
displacedbyascalartexturemap,avoidingtheexplicitdisplacement 
ofafinepre-tessellation.Ray-geometryintersectionalgorithmsoperatebyiterativelyshrinkingtheintervalalongtheraythrough 
spaceculling,typicallybytraversingtheraythroughaspatialstructurethatboundsthegeometryatmultiplescales.
Maintainingtight 
boundsiskeytoachievinggoodperformanceasitminimizesthe 
numberofcostlytraversalstepsrequiredtodescendtoascale 
whereanalyticintersectiontestingispossible.Tessellation-free 
displacementmapping(TFDM)[Thonatetal.2021]operatesintexturespace,
traversingaminmaxmipmapquad-tree.Whilesimple, 
thisschemesuffersfromslowintervaltighteningandlongtraversal,
forthreereasons:(1)Thetreestructureisfixedâ€”itdoesnot 
dependonthedisplacementdata;(2)Thetexture-spacefootprint 
(i.e.,projection)ofaraysegmentisgenerallyanisotropicbutthe 
treenodesonlyprovideconservativedisplacementboundsover 
square-shapedregions;(3)Hierarchypruningissolelybasedona 
simplebinary(yes/no)feedbackfromtheintersectionsoftheloose 
3D-boxboundsderivedfromthenodes. 


Themainideabehindourmethodistotracktightray-interval 
boundssimultaneouslyin2Dtexturespaceand3Dobjectspace.It 
isinspiredbytheobservationthateachspacehasaccesstounique 
informationthatcanbeleveragedtoeffectivelytightenthebound 
intheotherspace:Subdividinga2Draybound(i.e.,aregionin 
texturespaceboundingthecurvedrayprojection)yieldstighter 
scalardisplacementboundsandthustighter3D-surfacebounds.Intersectingthose3Dboundsthentightensthevalidrayintervaland 
shrinksits2Dfootprint.Thisping-pongschemecantightenbounds 
rapidlyandthusspeedupspacecullingtoreducethenumberoftraversalsteps;
Fig.3showsanillustrationinflatland.Pattersonetal. 
[1991]exploredtheschemeforanalyticalbasesurfaces;weextend 
ittotrianglemesheswithinterpolateddisplacementdirections. 



SAConferencePapersâ€™23,December12â€“15,2023,Sydney,NSW,Australia 



Figure3:Overviewofourtraversalalgorithmwhichpingpongsbetween2Dand3Dtoiterativelytightentherayintervalofpotentialintersection.(
a)Foragiveninitialbound(1) 
inthe2Ddisplacement-texturespace,wecomputedisplacementboundstoobtaina3Dboxaroundthedisplacedsurface. 
Projectingtheray-boxintersectionintervalbackintotexture 
spaceyieldsareduced2Dbound(2).(b)Thisray-bounding 
region(2)isthensubdividedintotwosubregions(3)which 
inturnyieldtighter3Dbounds.(c)Therayintervalofthe 
firstintersectedboxisprojectedbackonto2Dasinstep(a), 
andtheprocessrepeatsbyfeedingtheobtainedtighter2D 
bound(4)tostep(b). 


Fortheabove-describedschemetobeeffective,weneedtonot 
onlymap2Dray-intervalboundsto3Dgeometryboundsbutalso 
3Dray-intersectionintervalsbackto2D.Forthe2Dâ†’3Dmapping, 
weemployaffinearithmeticasThonatetal.[2021].Forthe3Dâ†’2D 
mapping,weusedisplacementinversiontoprojecttheendpointsof 
ray-intersectionintervalstoaxis-alignedboundsintexturespace. 
These2Dboundscanhavehighlyanisotropicrectangularshapes; 
conservativelysnappingthemtothepredefinedsquare-shaped 
nodesofaminmaxmipmapwouldyieldvalidbutexcessivelyloose 
boundsforthedisplacementinsidethem.Tothatend,weintroduceanoveldatastructure,
dubbedrectangularminmaximage 
pyramid(RMIP),thatprovidesdisplacementboundsforarbitrary 
axis-alignedrectangularregionsintexturespace.Crucially,RMIP 
divorcesusfromrigidtraversalhierarchiesandliberatesustocull 
spaceefficientlybasedonthespecificray-triangleconfiguration. 


Algorithmoverview.Figure2illustratesourmethod.Givena 
trianglemeshequippedwithper-vertexdisplacementnormalsand 
adisplacementtexture,wefirstconstructtheRMIPstructurewhich 
storesscalardisplacementboundsoverrectanglesofvarioussize 
andshapeintexturespace.Thenforeachtrianglewecomputea 
prismthattightlyboundsthedisplaced3Dsurfacearisingfromit; 
webuildaboundingvolumehierarchyoverallprisms. 


Duringraytracing,eachintersectedprismtriggersourpertriangletraversalalgorithm,
laidoutinAlg.1.Itfirstprojectsthe 
ray-prismintersectionintervaltotexturespace.This2Dprojection 
isacurvewhichmayneedtobesplitintosub-curvessothateach 
canbeboundedbytheaxis-alignedrectanglespannedbyitsendpoints;
theboundingrectanglesarepushedtoastack.Thetraversal 
loopthenpopsrectangularboundsfromthestackandalternatesbetween(
1)computing3D-surfaceboundsfromdisplacementbounds 
overrectanglesandintersectingthem(Fig.3a),and(2)projecting 
the3Dray-intersectionintervalsandsubdividingtherectangles 
thatboundthem(Fig.3b).Whenthecurrent2Dboundbecomes 
smallenough,weswitchtomarchingalongthedisplacementtexels 
itspans,locallyreconstructingthedisplaced3Dsurfaceforeach 


ThÃ©oThonat,IliyanGeorgiev,FranÃ§oisBeaune,andTamyBoubekeur 


Algorithm1:Pseudo-codeofourdisplacementintersection 
algorithmwhichiterativelytightensrayboundsinboth2D 
texturespaceand3Dobjectspace,usingourRMIPstructure. 


1:functionIntersectRMIP(ğ‘Ÿğ‘ğ‘¦,ğ‘¡ğ‘Ÿğ‘–ğ‘ğ‘›ğ‘”ğ‘™ğ‘’,ğ‘ğ‘Ÿğ‘–ğ‘ ğ‘š,ğ‘Ÿğ‘šğ‘–ğ‘) 


2: 
ğ‘ğ‘œğ‘–ğ‘›ğ‘¡ğ‘  
= 
sort(intersect(ğ‘Ÿğ‘ğ‘¦, 
ğ‘ğ‘Ÿğ‘–ğ‘ ğ‘š)) 
3: 
ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ğ‘  
= 
inversedisplacement(ğ‘ğ‘œğ‘–ğ‘›ğ‘¡ğ‘ , 
ğ‘¡ğ‘Ÿğ‘–ğ‘ğ‘›ğ‘”ğ‘™ğ‘’ 
)â†Section4.1 
4: 
ğ‘¡ğ‘¢ğ‘Ÿğ‘›ğ‘–ğ‘›ğ‘” 
ğ‘ğ‘œğ‘–ğ‘›ğ‘¡ğ‘  
= 
zeroğ‘¢ğ‘£ 
derivative(ğ‘Ÿğ‘ğ‘¦, 
ğ‘¡ğ‘Ÿğ‘–ğ‘ğ‘›ğ‘”ğ‘™ğ‘’ 
)â†Section4.2 
5: 
ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ğ‘  
= 
split(ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ğ‘ ,ğ‘¡ğ‘¢ğ‘Ÿğ‘›ğ‘–ğ‘›ğ‘” 
ğ‘ğ‘œğ‘–ğ‘›ğ‘¡ğ‘  
)â†Section4.2 
6: 
whileğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ğ‘  
isnotemptydo 
â†Stackof2Draybounds 
7: 
ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ 
= 
ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ğ‘ .pop() 
8: 
ifğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ 
issmallerthanğ‘šğ‘ğ‘Ÿğ‘â„ğ‘–ğ‘›ğ‘” 
ğ‘ ğ‘ğ‘ğ‘™ğ‘’ 
then 
9: 
forğ‘¡ğ‘’ğ‘¥ğ‘’ğ‘™ 
intexelmarching(ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘)do 
â†Section4.3 
10: 
ifâ„ğ‘–ğ‘¡ 
=displacedsurfaceintersect(ğ‘Ÿğ‘ğ‘¦,ğ‘¡ğ‘’ğ‘¥ğ‘’ğ‘™)then 
11: 
returnâ„ğ‘–ğ‘¡ 
â†Front-to-backtraversal,terminateonfirsthit 
12: 
ğ‘ğ‘œğ‘¥ 
= 
surfacebounds(ğ‘¡ğ‘Ÿğ‘–ğ‘ğ‘›ğ‘”ğ‘™ğ‘’,ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘, 
ğ‘Ÿğ‘šğ‘–ğ‘ 
)â†Section5 
13: 
ifnotâ„ğ‘–ğ‘¡ğ‘  
= 
intersect(ğ‘Ÿğ‘ğ‘¦,ğ‘ğ‘œğ‘¥ 
) 
then 
14: 
continue 
15: 
ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ 
= 
reduce(ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘, 
â„ğ‘–ğ‘¡ğ‘  
)â†Section4.3 
16: 
forğ‘“ 
ğ‘Ÿğ‘œğ‘›ğ‘¡, 
ğ‘ğ‘ğ‘ğ‘˜ 
insplit(ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ 
) 
do 
â†Section4.3 
17: 
ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ğ‘ .push(ğ‘ğ‘ğ‘ğ‘˜, 
ğ‘“ğ‘Ÿğ‘œğ‘›ğ‘¡ 
)â†Backfirstsofrontispopearlier 
texelandtestingitforintersections.UnlikeTFDM[Thonatetal. 
2021],thankstotraversinginafront-to-backmanneralongtheray, 
wecanterminateassoonaswefindanintersection. 


Usingboundingprismsprovidesagoodcompromisebetween 
intersectioncomplexityandtightness,especiallysinceitachieves 
spacesubdivisionâ€”thedisplaced-surfaceboundsofneighboring 
trianglesdonotoverlapin3D(seeFig.2c).Inthesupplemental 
documentwediscussthegeometryoftheprisms,howtoconstruct 
them,andhowtointersectthemtoobtaintheinitialboundsforthe 
traversal.Anevenmoreimportantadvantageofusingprismsover 
axis-aligned3Dboxesistheguaranteethatevery3Dlocationinside 
themcanbesuccessfullyprojectedtotexturespace.Wediscuss 
thisaspectinSection4below;there,wealsoformallydescribeour 
rectangulartexture-spaceraybounds,howourtraversaltightens 
thoseboundsiteratively,andhowweperformtexelmarching.In 
Section5wepresentournovelRMIPdatastructurethatprovides 
tightscalardisplacementboundsoverrectanglesintexturespace.In 
Section6wepresentresultsofourmethod,alongwithanablation 
studyarounddifferenttraversalcomponents. 


4 
TEXTURE-SPACETRAVERSAL 


Obtainingthetightestpossibledisplacementboundsalongaray 
requirestheabilitytotrackitsprojectionin2Dtexturespace.This 
projectionâ€”alongthedisplacement-directionfielddefinedbythe 
interpolatedvertexnormalsâ€”isacurve(seeFig.2d),andderiving 
anexplicit1Dparametrizationforitisdifficult.Luckily,asimple 
implicitformforthecurveiseasytoobtain.Thatform,incombinationwithpoint-
wisedisplacementinversion,allowsustobound 
thecurveusingaxis-alignedrectangles.Belowwedescribehow 
weprojecttheendpointsof3Drayintervalsto2Dlocationsand 
howwederivetightcurve-boundingrectanglesfromthemusing 
theimplicitform.Wealsoshowhowtousethatformtosubdivide 
thoseboundsandtomarchalongtheexactdisplacementtexels 
crossedbytheray. 



RMIP:Displacementray-tracingviainversionandoblongbounding 
SAConferencePapersâ€™23,December12â€“15,2023,Sydney,NSW,Australia 


Figure4:Numberofstepsrequiredforprojecting3Dpoints


ontoabasetrianglebynumericallyinvertingEq.(2)(lower 
isbetter),visualizedhereinfalsecolorfor3Dlocationson 
aplaneorthogonaltothebasetriangle.Notall3Dpoints 
canbesuccessfullyprojected;however,weonlydealwith 
pointslocatedinsideaprismaroundthetriangle,andthese 
areguaranteedtofallinsidethetriangle(seeSection4.1). 


4.1 
Point-wiseinversion 
AtrianglewithlinearlyinterpolatedpositionsP(ğ‘¢, 
ğ‘£)andnormals 
N(ğ‘¢, 
ğ‘£)attexturecoordinatesğ‘¢ğ‘£ 
mapstexturespacetoa3Dsurface 
N(ğ‘¢, 
ğ‘£)

S(ğ‘¢, 
ğ‘£) 
= 
P(ğ‘¢, 
ğ‘£)+â„(ğ‘¢, 
ğ‘£) 
(1)

âˆ¥N(ğ‘¢, 
ğ‘£)âˆ¥ 
whichisaresultofdisplacingPbyanamountâ„ 
inthedirectionN. 
ThedisplacementlinesaredepictedinFig.3a.Projectingapoint 
O+ğ‘¡Datdistanceğ‘¡ 
alongaraywithoriginOanddirectionDinto 
texturespacerequiresinvertingthismapping.Thatis,welookfor 
theğ‘¢ğ‘£ 
coordinateswhosedisplacementlineintersectsthepoint: 


(P(ğ‘¢, 
ğ‘£)âˆ’(O+ğ‘¡D))Ã—N(ğ‘¢, 
ğ‘£) 
= 
0. 
(2) 


Notethatthisisavectorequation.Inthecontextofshellmapping, 
Jeschkeetal.[2007]providedananalyticinverseofit,asa(scalar) 
cubicequationw.r.t.therayparameterğ‘¡.However,wefoundout 
thataniterativeNewton-basednumericalinversionofEq.(2)is 
bothfasterandmorestable.AsseeninFig.4,afewiterationsare 
typicallysufficienttoreachconvergence. 


Figure4alsoshowsthatthedisplacementinverseisnotdefined 
forevery3Dpoint.Thekeyadvantageofusingaprismasa3D 
boundingprimitiveoverasimpleaxis-alignedboxisthatitisfully 
containedinsidetheconvergenceregion,providingtheguarantee 
thatallourprojectionswillfallinsidethebasetriangle. 


4.2 
Implicitrayprojection 
Wenowhavetheabilitytoprojecttheendpointsofarayinterval 
totexturespace.Therectanglespannedbytheseprojectionswill 
boundthe2D-intervalcurveifthecurveâ€™spartialderivativesw.r.t. 
ğ‘¢ 
andğ‘£ 
arenon-zero,i.e.,ifthecurvedoesnotchangeitsprincipal 
directioninsidetherectangle,asshownbyPattersonetal.[1991]. 
Wethereforemustidentifysuchâ€œturningâ€pointsandsubdivide 
thecurvedintervalintosub-intervalswithnon-zeroderivatives 
thatcaneachbeeasilyrectangle-bounded.Theprojectedrayhas 
asimpleimplicitform,allowingustoretrievethosepointsusing 
closed-formcomputations.Thatformisderivedbytransforming 
Eq.(2)toremoveitsdependencyontherayparameterğ‘¡: 


ğœ“ 
(ğ‘¢, 
ğ‘£) 
= 
det(P(ğ‘¢, 
ğ‘£)âˆ’O, 
N(ğ‘¢, 
ğ‘£), 
D) 
= 
0. 
(3) 


Figure5:Ourtraversalnarrowsdownthesearchalongthe 
raybytighteningits2Dboundintwoways.(a)Projectingthe 
endpointsofthe3D-boundintersectionintervaltotexture 
spacecanyieldatighter2Dbound.(b)Additionallyprojectingtheintervalâ€™smidpoint[
Pattersonetal.1991]allows 
subdividingthe2Dboundbutyieldsunbalancedtraversals 
andsuboptimalspaceculling.(c)Weinsteaddirectlysplit 
the2Dboundinthemiddle,withanumberofadvantages: 
itisfaster,cullshalftheboundarea,yieldsamorebalanced 
traversal,andboundsthenumberoftraversalsteps. 


Thisisaquadricintexturespacewithpartialderivatives

 


ğœ“ğ‘¢ 
det(Pğ‘¢, 
N(ğ‘¢, 
ğ‘£), 
D)+det(P(ğ‘¢, 
ğ‘£)âˆ’O, 
Nğ‘¢, 
D)

= 
, 
(4)

ğœ“ğ‘£ 
det(Pğ‘£, 
N(ğ‘¢, 
ğ‘£), 
D)+det(P(ğ‘¢, 
ğ‘£)âˆ’O, 
Nğ‘£, 
D)

wherePğ‘¢ 
,Pğ‘£,Nğ‘¢ 
,andNğ‘£,arethepartialderivativesoftheinterpo


latedbasepositionandnormalâ€”allconstantinsideabasetriangle. 


Eachğœ“ğ‘¢ 
= 
0andğœ“ğ‘£ 
= 
0definesalineintexturespace.
Wecanretrievethezero-derivative 
pointsbyintersectingtheprojectedraywith 
thosetwolines,whichboilsdowntosolving 
twoquadraticequations.Thisyieldsatmost 



foursuchpoints,meaningatmostfoursubdivisionsoftheinitial 
interval.Inpracticeweneverendupsubdividingmorethanonce. 


4.3 
Ray-boundtightening 
Thegoalofthetraversalistotightentheraybounduntilitissmall 
enoughtoallowdirectintersectiontestswithalocal,texel-level 
reconstructionofthedisplacedsurface.Wehavetwowaystoshrink 
thatboundwhichweillustrateinFig.5anddetailnext. 


Ray-intervalprojection.Everytimeweperformray-boxintersectionin3D,
weinvertthedisplacementfortheintersection-interval 
endpoints(Fig.5a).Thiscanyieldanew2Drayboundthatis 
tighterthantheinitialone,sometimesdrastically.Raysthatare 
near-paralleltothedisplacementdirectionshave2Dprojections 
smallerthanthesizeofatexel.Traversal-timecomplexityisthus 
constantforsuchraysastheycanbedirectlytestedagainstthe 
displacedsurfacewithinthattexel. 


Boundsubdivision.Boundtighteningviaintervalprojectionis 
beneficialonlyforsomerays.Weneedexplicitsubdivisiontoguaranteethatboundseventuallyshrinktoasizesmallenoughfor 
directintersection.Tothatend,Pattersonetal.[1991]projectthe 
3Dintersection-intervalmidpointtotexturespacetoformthetwo 
subdomains(Fig.5b).However,inourcasethe3Dboundsarecomputedusingrangearithmetic,
providingnotightnessguarantee. 



SAConferencePapersâ€™23,December12â€“15,2023,Sydney,NSW,Australia 


Thusthemidpointtexture-spaceprojectioncanlieanywherealong 
theprojectedray,whichcanleadtounbalancedsplittingandarbitrarilylongtraversal.
Weinsteadsplitthedomaindirectlyin 
texturespace:weusetheimplicitformtocomputetheintersection 
betweentheintervalcurveandthelinesplittingthelongersideof 
theboundinthemiddle(Fig.5c).Thisschemecullshalfthebound 
areaandputsastrictupperboundonthenumberoftraversalsteps. 


4.4 
Texelmarching 
Thefinalstageofourtraversalroutineisadirectintersectiontest 
withalocalreconstructionofthedisplacedsurface.Thisstepis 
triggeredwhenthe2Dboundsbecomesmallenough,typicallythe 
sizeofatexel[Thonatetal.2021]. 


However,wefoundthatitismore 
efficienttostopthetraversalearlier, 
andmarchalongtheprojectedray 
throughthetexelsitcrosses.Thesign 
oftheimplicitformğœ“ 
(3)ateachtexel 
cornerindicatesfromwhichedgethe 
rayleavesthetexel,asillustratedin 



theinlinefigureontheright. 


Weidentifytworeasonswhyswitchingtodirectintersection 
earlierismoreefficient.Firstly,our2Dboundsarearbitraryrectanglesthatarenotalignedwiththetexelsofthedisplacementmap. 
Thatis,atexelistypicallycoveredbymultiplerectanglesalongthe 
ray,whichleadstomultiple,redundantdirect-intersectiontestsfor 
thattexel.Texelmarchingamortizesthisredundancy.Secondly,the 
(finest)resolutionofourRMIPstructuremaybesmallerthanthat 
oftheinputdisplacementmap.Oncethe2Drayboundsbecome 
smallerthantheRMIPresolution,thescalardisplacementbounds 
returnedbyRMIPstopgettingtighter.Texelmarchingallowsto 
avoidqueryingtheRMIPbelowthisthresholdsize.InSection6we 
discusstheperformanceimpactoftherectangle-sizethresholdat 
whichweswitchtotexelmarching. 


5 
RMIPSTRUCTURE 


Theaxis-alignedboundsofrayintervalsintexturespacecanhave 
arbitraryrectangularshape,assumingtheraysareuniformlydistributedin3D.
Recallthatourtraversalrequiresboundsforthe 
scalardisplacementinsidetheserectangles.Aminmaxmipmap,the 
standarddatastructureusedtoretrievesuchbounds,wouldprovide 
excessivelylooseboundsforhighlyanisotropicqueries.Tothatend, 
inthissectionweintroduceanovelminmaxdatastructurethat 
wecallrectangularminmaximagepyramid(RMIP),whichprovides 
boundsforarbitrarilyshapedrectangles. 


The2Drangeminimumquery(RMQ)problemasksfortheminimumvalueoveraxis-
alignedrectangularregionswithinadiscrete 
2Dgrid.Thisproblemhasbeenwellstudiedintheliterature,and 
solutionstypicallyrelyonpre-possessingtheinputgridintoa 
datastructure,withdifferenttrade-offsincomplexitybetweenpreprocessingtime,
querytime,andstorage[FischerandHeun2011; 
Brodaletal.2012].Solutionstothe2DRMQproblemwithconstanttimequeryandasymptoticlinearpre-
processingtimeandstorage 
areknown[YuanandAtallah2010],buttheamountofintermediatedatastructuresandindirectionsrequiredforaquerymakethe 
practicalityofanimplementationunclearforrealtimerendering. 


ThÃ©oThonat,IliyanGeorgiev,FranÃ§oisBeaune,andTamyBoubekeur 



Figure6:LayoutofourRMIPstructureasa2Dtexturewith 
multiplelayers(columns)andmiplevels(rows).Eachpixel 
ofeverysub-texturerepresentsthetop-leftcornerofaquery 
andstorestheminmaxdisplacementvalueoveraregion 
ofsize(2ğ‘ 
, 
2ğ‘ 
).Weshowexamplequeriesincolor,withtopleftcornersmarkedbycircles.
Greenqueriesarecontained 
fullyinsidetheunittexturesquare;orangequeriescrossthe 
square,enablingtheuseofAlg.2withwrappingqueries. 
Semi-transparentlayersarecopiesofotherlayerswithinthe 
samemiplevel,enablinghardwaresamplingatfractional 
levelofdetail(LoD),i.e.interpolationacrosslevels(rows). 


WeinsteadfollowtheapproachofAmiretal.[2007],whonoted 
thatany2Drangequerycanbedecomposedintofour,possibly 
overlappingsub-querieswhosesidelengthsarepowersoftwo.Itis 
thereforesufficienttopre-computetheminmaxvaluesforallsuch 
sub-queries.Suchaqueryisspecifiedbyitssidelength(2ğ‘ 
, 
2ğ‘ 
), 
with0â‰¤ğ‘, 
ğ‘ 
â‰¤log2ğ‘ 
,andthepositionofitstopleftcorner(ğ‘¥,ğ‘¦), 
with0â‰¤ğ‘¥ 
< 
ğ‘ 
âˆ’2ğ‘ 
,and0â‰¤ğ‘¦ 
< 
ğ‘ 
âˆ’2ğ‘ 
.Weassumetheinput 
displacementmapissquarewithpower-of-twosideğ‘ 
.Wedenote 


ğ‘,ğ‘ 


byğ»ğ‘¥,ğ‘¦ 
theprecomputedminmaxquerywithsize(2ğ‘ 
, 
2ğ‘ 
) 
and 
position(ğ‘¥,ğ‘¦).Thequeryforarectanglewitharbitrarysize(ğ‘¤, 
â„)
andtop-leftposition(ğ‘¥,ğ‘¦)istheminmaxoffourğ» 
values: 


 


ğ‘,ğ‘ 
ğ‘,ğ‘ 
ğ‘,ğ‘ 
ğ‘,ğ‘ 


ğ‘…ğ‘€ğ‘„ 
(ğ‘¥,ğ‘¦,ğ‘¤, 
â„) 
= 
minmaxğ»ğ‘¥,ğ‘¦, 
ğ»ğ‘šğ‘¥ 
,ğ‘¦, 
ğ»ğ‘šğ‘¥ 
,ğ‘šğ‘¦ 
, 
ğ»ğ‘¥,ğ‘šğ‘¦ 
, 
(5) 


where 


(ğ‘, 
ğ‘) 
= 
âŒŠlog2(ğ‘¤, 
â„)âŒ‹, 


(ğ‘šğ‘¥ 
,ğ‘šğ‘¦ 
) 
= 
(ğ‘¥,ğ‘¦)+(ğ‘¤, 
â„)âˆ’(2ğ‘ 
, 
2ğ‘). 


Wehave(1+log2ğ‘ 
)2possiblequery 
sizes,andforeachwehaveğ‘ 
2possible 
positions,sothereareğ‘ 
2(1+log2ğ‘ 
)2 
totalminmaxğ» 
values.Weassemblethevaluesforeachquerysize 
(2ğ‘ 
, 
2ğ‘ 
)intoa2Dgrid,atpower-of-twoscales.Wepackallgrids 
intoonemulti-layer,multi-leveltexturethatmapsefficientlyonto 
trianglemeshes.Thistexture,depictedinFig.6,iswhatwecallour 
RMIPstructure;Alg.2showspseudo-codeforqueryingit. 



Inthesupplementaldocumentwedescribehowweconstruct 
theRMIPfromagivendisplacementmap,andhowwepractically 
reduceitsmemoryfootprintfromğ‘ 
2(1+log2ğ‘ 
)2toğ‘ 
2,i.e.tothe 
orderofaclassicalmipmap.Wealsodiscussdetailsaboutbounding 
continuouslyinterpolated(displacement)signals,tiledovertheğ‘¢ğ‘£ 
plane,andfractional-LoDsupport. 



RMIP:Displacementray-tracingviainversionandoblongbounding 


Algorithm2:Rangeminmaxquery(RMQ)usingourRMIP 
structure,foragivenğ‘¢ğ‘£ 
rectangleanda(possiblyfractional) 
levelofdetail(LoD)ğœ†. 


1:functionRMIP_RMQ(ğ‘¢ğ‘£min,ğ‘¢ğ‘£max,ğœ†,ğ‘Ÿğ‘šğ‘–ğ‘) 


2: 
ğ‘Ÿ 
= 
textureSize(ğ‘Ÿğ‘šğ‘–ğ‘, 
0)â†RMIPresolutionatLoD0 
3: 
ğ‘min= 
âŒŠğ‘¢ğ‘£minÂ·ğ‘Ÿ 
âŒ‹, 
ğ‘max 
= 
âŒˆğ‘¢ğ‘£maxÂ·ğ‘Ÿ 
âŒ‰â†Querypixelcorners 
4: 
ğ‘  
= 
âŒŠlog2(ğ‘maxâˆ’ğ‘min)âŒ‹ 
â†Querylogsizeinpixels 
5: 
ğ‘– 
= 
ğ‘ .ğ‘¥ 
+ğ‘ .ğ‘¦ 
Â·rmiparraystride 
â†RMIPtexturearraylayerindex 
6: 
ğ‘¢ğ‘£min= 
(ğ‘min+0.5)/ğ‘Ÿ 
â†Adjusttopixelcenter 
7: 
ğ‘¢ğ‘£mid= 
(ğ‘max+0.5âˆ’2ğ‘  
)/ğ‘Ÿ 
â†Bottom-leftsub-queryâ€™stopright 
8: 
ğ‘1= 
textureLoD(ğ‘Ÿğ‘šğ‘–ğ‘,ğ‘¢min, 
ğ‘£min, 
ğ‘–, 
ğœ†)â†Top-leftsub-query 
9: 
ğ‘2= 
textureLoD(ğ‘Ÿğ‘šğ‘–ğ‘,ğ‘¢mid, 
ğ‘£min, 
ğ‘–, 
ğœ†)â†Top-rightsub-query 
10: 
ğ‘3= 
textureLoD(ğ‘Ÿğ‘šğ‘–ğ‘,ğ‘¢min, 
ğ‘£mid, 
ğ‘–, 
ğœ†)â†Bottom-leftsub-query 
11: 
ğ‘4= 
textureLoD(ğ‘Ÿğ‘šğ‘–ğ‘,ğ‘¢mid, 
ğ‘£mid, 
ğ‘–, 
ğœ†)â†Bottom-rightsub-query 
12: 
returnminmax(ğ‘1,ğ‘2,ğ‘3,ğ‘4) 
Formicro-structurerendering,Wangetal.[2020]proposeda 
similardatastructure,alsobasedonthatofAmiretal.[2007].Our 
RMIPstructureencodesarichersetofqueries,supportingtiled 
signalsandfractionalLoDs,andhasaGPU-friendlyimplementation. 
Moreover,ourcompressionschemeisbettersuitedtoray-tracing 
applicationswhereboundtightnessiscrucialatearlytraversalsteps. 
Ourschemereducestightnessmostlyonqueriessmallerthanthe 
RMIPresolution,whichonlyoccurlateinthetraversal.Incontrast, 
squaredprecomputedqueriesyieldlooserboundsatallscales. 


6 
RESULTS 


WeimplementedourmethodonCPUandGPU,usingEmbree[Wald 
etal.2014]andVulkanRayTracing[Khronos2020].Ourtwo-level 
approach(findbasetriangle,thenintersectit)issupportedbythose 
ray-tracingframeworksthroughcustomgeometry.Itrequiresa 
boundingboxforeachcustomprimitiveâ€”perboundingprismin 
ourcase,andacustomintersectionprogramâ€”ourhybridtraversal. 


WepresentresultsofourmethodintegratedintheAdobeMercuryRenderingEngine.
Weshowexampleswithhigh-resolution 
displacementmaps,arangeoftilingfactors,andvarietyofbase 
surfaces,seeninFig.8.Allresultswereproducedonadesktopmachinewitha16-
coreAMDRyzen95950XCPUandanNVIDIARTX 
3080GPUwith10GBofmemory.Weevaluateourmethodalong 
threeaxes:performance,visualquality,andmemoryfootprint. 


Tessellation-freedisplacement.OurmaincompetitoristheTFDM 
method[Thonatetal.2021].Asweshareacommontessellation-free 
framework,ourshasidenticalinputsandoutputs,andyieldsthe 
samevisualquality.Wethereforecompareperformanceandmemoryconsumption.
AsseeninTable1,ourssignificantlyoutperforms 
TFDMinanequal-memorysetup,withanaveragespeed-upof5Ã— 
(witha3Ã—standarddeviation)overallscenes.Wealsoshowthat 
wecanreachtheirlevelofperformancewithonlyafractionofthe 
memorycost.InFig.10,weshowthatourmethodperformsincreasinglybetterwhenpushingthedisplacementscalingordisplacement 
tiling,confirmingitsbetterasymptotictraversalcomplexity.Finally, 
Fig.9showsthatourray-adaptivehierarchiesreducethenumber 
ofconsidered2Dboundsduringtraversal(i.e.,thesizeofthewhile 
loopinAlg.1)byanorderofmagnitudeoverTFDM. 


SAConferencePapersâ€™23,December12â€“15,2023,Sydney,NSW,Australia 



Figure7:Causticsrenderedusingphotonmapping,without 
displacementmapping(left)andusingourmethod(right). 


Editability.Asourdatastructuresareefficienttocomputeon 
theGPU,displacementeditingisaseasyasinTFDM.Displacement 
modificationstriggeranRMIPrebuild.Withourcompression,thisis 
equivalenttobuildingaminmaxmipmap,andtakesapproximately 
5msfora4kdisplacementmapusinganaiveimplementation.On 
theotherhand,modifyingthedisplacementparameterstriggers 
pre-computationsonlyforthebasetriangles,mostnotablythe 
boundingprisms,whichtakeslessthan1msonallourexamples. 


Ablationstudy.Westudyseveralcomponentsofourmethod. 
First,weswapoutRMIPforastandardminmaxmipmapinour 
traversal.Suchamipmapcanbeusedtocomputeboundsonan 
arbitraryaxis-alignedrectanglebyfindingthesmallestfourneighboringtexelswhoseunioncontainstherectangle[
Greeneetal. 
1993],asusedforGPUocclusionculling[Shopfetal.2008].In 
Fig.11weshowthatinourray-tracingcontext,atequivalentmemoryconsumption,
theboundsobtainedfromthemipmapdegrades 
performancecomparedtoRMIP.Thisisbecausethequeriesare 
madeoverarbitraryrectanglesboundingrayprojections,andthe 
mipmapperformspoorlyforsuchgenerallyanisotropicqueries. 


Second,werelyontexelmarchingtobothamortizequery-texel 
misalignmentsandcompensateforthelimitedRMIPresolution. 
Weuseamarchingscaleparametertocontrolthe2D-sizethreshold 
belowwhichweswitchfromboundsubdivisiontotexelmarching.
InFig.11weshowthatforeveryRMIPresolutionthereisa 
marching-scalesweet-spotthatgivesthebestperformance.Intuitively,
alargescaleleadstoadisplacement-maptraversalwithout 
muchhierarchicalacceleration,whichiscostlyforhigh-resolution 
maps.Conversely,asmallmarchingscalemeansthequery-texel 
misalignmentandlimitedRMIPresolutionarenolongeramortized. 


Finally,westudytheefficiencyof2D-boundtighteningthrough 
point-wisedisplacementinversion(Fig.5a).Whileinversioniscriticalforinitializingthetraversal,
itsusageduringtraversal(line15 
inAlg.1)isoptionalsince2D-boundsubdivision(Fig.5c)isenough 
toguaranteeconsistentboundshrinkage.WeshowinFig.12,that 
whileinversionprovidessignificantperformanceimprovementon 
averageonCPU,itsbenefitonGPUismuchlesspronounced.We 
hypothesizethatthisdifferenceisduetotheSIMDnatureofthe 
GPUexecutionmodel.Indeed,whilenumericalinversionisrelativelyfast,
itremainsacostlyoperationthatprovidesasignificant 
regionreductiononlyincertainconfigurations,e.g.,whentheray 
hitsanon-the-fly3DAABBfromthetoporbottom.Sosinceour 
traversalisheavilyray-dependant,itisunlikelythatmultipletraversalswithinanexecutionwarpencounterabeneficialinversion. 



Ã—0.048Ã—2.7Ã—0.048Ã—5.0Ã—0.012Ã—4.3Ã—0.012Ã—2.5Ã—0.048Ã—2.5Ã—0.012Ã—2.7Ã—0.048Ã—6.1Ã—0.048Ã—2.2Ã—2.5Ã—2.7Ã—0.048Ã—5.0Ã—0.012Ã—4.3Ã—0.012Ã—2.5Ã—0.048Ã—2.5Ã—0.012Ã—2.7Ã—0.048Ã—6.1Ã—0.048Ã—2.2Ã—2.5
SAConferencePapersâ€™23,December12â€“15,2023,Sydney,NSW,Australia 
ThÃ©oThonat,IliyanGeorgiev,FranÃ§oisBeaune,andTamyBoubekeur 


Table1:Performanceandmemory-footprintcomparisonbetweenTFDM[Thonatetal.2021](servingasa1Ã—baseline),uniform 
tessellation,andourmethodwiththreedifferentresolutionsforourRMIPstructure.Foreachconfigurations,therightcolumn 
comparesthedatastructurememoryconsumption(lowerisbetter),andtherightcolumnreportsrender-timespeed-upson 
GPU(higherisbetter).Visualcomparisonsareshowninthesupplementaldocument. 


Scene 
#Tri 
Disp. 
Tiling 
TFDM(1Ã—) 
Pre-tessellation 
Ourtraversal 
[Thonatetal.2021] 
Uniform 
Low-res.RMIP 
RMIP 
High-res.RMIP 
Mem. 
GPU 
Mem.â†“ 
GPUâ†‘ 
Mem.â†“ 
GPUâ†‘ 
Mem.â†“ 
GPUâ†‘ 
Mem.â†“ 
GPUâ†‘ 


AlienSphere 
0.9k 
2k 
6Ã—8 
21Mb 
56ms 
Ã—186 
Ã—91 


Ã—1.3 
Ã—3.4 
Ã—30 
Ã—2.7 
Basket 
4.8k 
2k 
5Ã—5 
21Mb 
117ms 
Ã—235 
Ã—67 


Ã—1.3 
Ã—6.3 
Ã—30 
Ã—5.0 
Creature 
53k4k 
1Ã—1 
85Mb 
115ms 
Ã—40 
Ã—232 


Ã—1.6 
Ã—7.8 
Ã—7.6 
Ã—9.3 
DivingHelmet 
2.5k 
4k 
1Ã—1 
85Mb 
33ms 
Ã—30 
Ã—95 


Ã—1.6 
Ã—3.0 
Ã—7.6 
Ã—3.5 
MedievalHelmet 
2.3k 
2k 
5Ã—5 
21Mb 
42ms 
Ã—111 
Ã—93 


Ã—1.3 
Ã—3.2 
Ã—30 
Ã—2.8 
ElvenArmor 
0.8k 
4k 
2Ã—2 
85Mb 
53ms 
Ã—37 
Ã—132 


Ã—1.6 
Ã—3.4 
Ã—7.6 
Ã—4.1 
NinjaHead 
8.7k 
2k 
5Ã—5 
21Mb 
182ms 
Ã—103 
Ã—340 


Ã—1.3 
Ã—9.2 
Ã—30 
Ã—7.7 
TerracottaRoof 
1282k 
2Ã—2 
21Mb 
27ms 
Ã—97 
Ã—69 


Ã—1.3 
Ã—3.0 
Ã—30 
Ã—2.4 
DesertTire 
9k 
4kÃ—3 
252,6Ã—1 
256Mb 
606ms 
Ã—10 
Ã—1151 
Ã—0.012 
Ã—6.5 
Ã—0.32 
Ã—11 
Ã—7.6 
Ã—9.6 
Glass 
2.2k 
2k 
1Ã—1 
42Mb 
41ms 
Ã—51 
Ã—12 
Ã—0.66 


Ã—1.3 
Ã—2.7 
Ã—16 
Ã—2.7 


7 
DISCUSSION 


Limitations&futurework.Whenusingdisplacementmapswith 
moderateresolutionorlimitedtiling,andkeepingthedisplacement 
contentstatic,thencombiningpre-tessellation,pre-displacement, 
andhardwareraytracingremainsthemethodofchoice,evenifaccuratedisplacementmeshingcanbeverychallengingdependingon 
theactualUVlayoutofthebasedomain.Anumberofdesignchoices 
inourapproachareheavilybiasedbyourapplicationscenarioâ€” 
dynamicGPUdisplacementtracing.Nevertheless,webelievethat 
RMIPcouldbeinstrumentalinanumberofotherlevel-of-detail 
problems,includingapproximationmodelsforphysicssimulation 
andhigh-resolutiongeomapping. 


Conclusion.Bycouplingdisplacementinversionwithrangearithmetic,
ourmethodestablishesanefficientbidirectionalcommunicationchannelbetweentexturespaceand3Dspace,
enablingefficient 
andray-dependenttexture-spacepruningwhenseekinganintersection.
Asaresult,RMIPdisplacementraytracingisonaverage 
fivetimesfasterthanthestateoftheartatequalimagequality. 


ACKNOWLEDGMENTS 


TheauthorsthankLucChamerlatforhelpingcreateourbeautiful 
testscenes,AndrÃ©aMachizaudforhisreliableassistancewiththe 
renderer,ThomasCaissardforhelpingwithphotonmapping,and 
theanonymousreviewersfortheirtheirusefulfeedback. 


REFERENCES 


AmihoodAmir,JohannesFischer,andMosheLewenstein.2007.Two-dimensionalrange 


minimumqueries.InCombinatorialPatternMatching:18thAnnualSymposium,CPM 


2007,London,Canada,July9-11,2007.Proceedings18.Springer,286â€“294. 
LionelBaboud,ElmarEisemann,andHans-PeterSeidel.2011.Precomputedsafety 


shapesforefficientandaccurateheight-fieldrendering.IEEEtransactionsonvisu


alizationandcomputergraphics18,11(2011),1811â€“1823. 
GerthStÃ¸ltingBrodal,PooyaDavoodi,andSSrinivasaRao.2012.Onspaceefficient 


twodimensionalrangeminimumdatastructures.Algorithmica63(2012),815â€“830. 
NathanACarr,JaredHoberock,KeenanCrane,andJohnCHart.2006.FastGPUray 


tracingofdynamicmeshesusinggeometryimages..InGraphicsInterface,Vol.2006. 


Citeseer,203â€“209. 
PerH.Christensen,DavidM.Laur,JuliaFong,WayneL.Wooten,andDana 


Batali.2003. 
RayDifferentialsandMultiresolutionGeometryCaching 


forDistributionRayTracinginComplexScenes. 
ComputerGraphicsForum22,3(
2003),543â€“552. 
https://doi.org/10.1111/1467-8659.t01-1-00702 
arXiv:https://onlinelibrary.wiley.com/doi/pdf/10.1111/1467-8659.t01-1-00702 


PeterDjeu,WarrenHunt,RuiWang,IkrimaElhassan,GordonStoll,andWilliamR. 
Mark.2011.Razor:AnArchitectureforDynamicMultiresolutionRayTracing. 
ACMTrans.Graph.30,5,Article115(Oct.2011),26pages. 
https://doi.org/10.1145/ 
2019627.2019634 


WilliamDonnelly.2005.Per-pixeldisplacementmappingwithdistancefunctions. 
GPUgems2,22(2005),3. 


JonathanDummer.2006.Conestepmapping:Aniterativeray-heightfieldintersection 
algorithm.URL:http://www.lonesock.net/files/ConeStepMapping.pdf2,3(2006),4. 


JohannesFischerandVolkerHeun.2011.Space-efficientpreprocessingschemesfor 
rangeminimumqueriesonstaticarrays.SIAMJ.Comput.40,2(2011),465â€“492. 


NedGreene,MichaelKass,andGavinMiller.1993.HierarchicalZ-buffervisibility. 
InProceedingsofthe20thannualconferenceonComputergraphicsandinteractive 
techniques.231â€“238. 


JohannesHanika,AlexanderKeller,andHendrikP.A.Lensch.2010.Two-LevelRay 
TracingwithReorderingforHighlyComplexScenes.InProceedingsofGraphics 
Interface2010(Ottawa,Ontario,Canada)(GIâ€™10).CanadianInformationProcessing 
Society,CAN,145â€“152. 


TakahiroHarada.2015.RenderingVectorDisplacementMappedSurfacesinaGPU 
RayTracer.GPUPro6:AdvancedRenderingTechniques(2015),459. 


JohnCHart.1996.Spheretracing:Ageometricmethodfortheantialiasedraytracing 
ofimplicitsurfaces.TheVisualComputer12,10(1996),527â€“545. 


W.HeidrichandH.Seidel.1998.Ray-tracingProceduralDisplacementShaders.In 
GraphicsInterface. 


WarrenHunt,WilliamR.Mark,andDonFussell.2007.FastandLazyBuildofAccelerationStructuresfromSceneHierarchies.
In2007IEEESymposiumonInteractive 
RayTracing.47â€“54.https://doi.org/10.1109/RT.2007.4342590 


StefanJeschke,StephanMantler,andMichaelWimmer.2007.InteractiveSmooth 
andCurvedShellMapping.InProceedingsofthe18thEurographicsConference 
onRenderingTechniques(Grenoble,France)(EGSRâ€™07).EurographicsAssociation, 
Goslar,DEU,351â€“360. 


TomomichiKaneko,ToshiyukiTakahei,MasahikoInami,NaokiKawakami,Yasuyuki 
Yanagida,TaroMaeda,andSusumuTachi.2001.Detailedshaperepresentation 
withparallaxmapping.InProceedingsofICAT,Vol.2001.205â€“208. 


Khronos.2020.VulkanRayTracingspecification. 
https://www.khronos.org/blog/ 
vulkan-ray-tracing-final-specification-release 


AlexandrKuznetsov,KrishnaMullia,ZexiangXu,MiloÅ¡HaÅ¡an,andRaviRamamoorthi. 
2021.NeuMIP:multi-resolutionneuralmaterials.ACMTransactionsonGraphics 
(TOG)40,4(2021),1â€“13. 


AlexandrKuznetsov,XuezhengWang,KrishnaMullia,FujunLuan,ZexiangXu,Milos 
Hasan,andRaviRamamoorthi.2022. 
RenderingNeuralMaterialsonCurved 
Surfaces.InACMSIGGRAPH2022ConferenceProceedings.1â€“9. 


L.Lee,Shih-WeiTseng,andW.Tai.2009.ImprovedReliefTextureMappingUsing 
MinmaxTexture.2009FifthInternationalConferenceonImageandGraphics(2009), 
547â€“552. 


JamesRLogieandJohnW.Patterson.1995.Inversedisplacementmappinginthe 
generalcase.InComputerGraphicsForum,Vol.14.WileyOnlineLibrary,261â€“273. 



RMIP:Displacementray-tracingviainversionandoblongbounding 


AndreaMaggiordomo,HenryMoreton,andMarcoTarini.2023.Micro-MeshConstruction.
ACMTransactionsonGraphics(TOG)42,4(2023),1â€“18. 


KyoungsuOh,HyunwooKi,andCheol-HiLee.2006.Pyramidaldisplacementmapping: 
agpubasedartifacts-freeraytracingthroughanimagepyramid.InProceedingsof 
theACMsymposiumonVirtualrealitysoftwareandtechnology.75â€“82. 


JohnWPatterson,StuartGHoggar,andJamesRLogie.1991.Inversedisplacement 
mapping.InComputerGraphicsForum,Vol.10.WileyOnlineLibrary,129â€“139. 


FabioPolicarpoandManuelMOliveira.2007.Relaxedconesteppingforreliefmapping. 
GPUgems3(2007),409â€“428. 


FÃ¡bioPolicarpo,ManuelMOliveira,andJoÃ£oLDComba.2005. 
Real-timerelief 
mappingonarbitrarypolygonalsurfaces.InProceedingsofthe2005symposiumon 
Interactive3Dgraphicsandgames.155â€“162. 


SerbanD.Porumbescu,BrianBudge,LouisFeng,andKennethI.Joy.2005.ShellMaps. 
ACMTrans.Graph.24,3(July2005),626â€“633. 
https://doi.org/10.1145/1073204. 
1073239 


V.V.Sanzharov,V.A.Frolov,andV.A.Galaktionov.2020.SurveyofNvidiaRTX 
Technology.Program.Comput.Softw.46,4(jul2020),297â€“304. 
https://doi.org/10. 
1134/S0361768820030068 


JeremyShopf,JoshuaBarczak,ChristopherOat,andNatalyaTatarchuk.2008.March 
oftheFroblins:simulationandrenderingmassivecrowdsofintelligentanddetailed 
creaturesonGPU.InACMSIGGRAPH2008Games.52â€“101. 


BrianSmits,PeterShirley,andMichaelMStark.2000.Directraytracingofdisplacement 
mappedtriangles.InEurographicsWorkshoponRenderingTechniques.Springer, 
307â€“318. 


LÃ¡szlÃ³Szirmay-Kalos,TamÃ¡sUmenhoffer,GustavoPatow,LÃ¡szlÃ³SzÃ©csi,andMateu 
Sbert.2009.Speculareffectsonthegpu:Stateoftheart.InComputerGraphics 
Forum,Vol.28.WileyOnlineLibrary,1586â€“1617. 


NatalyaTatarchuk.2006.Dynamicparallaxocclusionmappingwithapproximatesoft 
shadows.InProceedingsofthe2006symposiumonInteractive3Dgraphicsandgames. 
63â€“69. 


ArtTevs,IvoIhrke,andHans-PeterSeidel.2008.Maximummipmapsforfast,accurate, 
andscalabledynamicheightfieldrendering.InProceedingsofthe2008symposium 
onInteractive3Dgraphicsandgames.183â€“190. 


TheoThonat,FrancoisBeaune,XinSun,NathanCarr,andTamyBoubekeur.2021. 
Tessellation-FreeDisplacementMappingforRayTracing.40,6,Article282(dec 
2021),16pages. 
https://doi.org/10.1145/3478513.3480535 


IngoWald,SvenWoop,CarstenBenthin,GregorySJohnson,andManfredErnst.2014. 
Embree:akernelframeworkforefficientCPUraytracing.ACMTransactionson 
Graphics(TOG)33,4(2014),1â€“8. 


BeibeiWang,MiloÅ¡HaÅ¡an,NicolasHolzschuch,andLing-QiYan.2020.Example-based 
microstructurerenderingwithconstantstorage.ACMTransactionsonGraphics 
(TOG)39,5(2020),1â€“12. 


LifengWang,XiWang,XinTong,StephenLin,ShiminHu,BainingGuo,andHeungYeungShum.
2003.View-dependentdisplacementmapping.ACMTransactionson 
graphics(TOG)22,3(2003),334â€“339. 


XiWang,XinTong,StephenLin,ShiminHu,BainingGuo,andHeung-YeungShum. 
2004.Generalizeddisplacementmaps.InProceedingsoftheFifteenthEurographics 
conferenceonRenderingTechniques.227â€“233. 


KeithYerexandMartinJÃ¤gersand.2004.Displacementmappingwithray-castingin 
hardware..InSIGGRAPHsketches.149. 


HaoYuanandMikhailJAtallah.2010.Datastructuresforrangeminimumqueries 
inmultidimensionalarrays.InProceedingsofthetwenty-firstannualACM-SIAM 
symposiumonDiscreteAlgorithms.SIAM,150â€“160. 


SAConferencePapersâ€™23,December12â€“15,2023,Sydney,NSW,Australia 



SAConferencePapersâ€™23,December12â€“15,2023,Sydney,NSW,Australia 
ThÃ©oThonat,IliyanGeorgiev,FranÃ§oisBeaune,andTamyBoubekeur 



Figure8:OfflinerendersofscenesfromThonatetal.[2021]thatweusedinourcomparisons;lefttoright,toptobottom:Alien 
Sphere,Basket,DivingHelmet,Creature,MedievalHelmet,ElvenArmor,TerracottaRoof,andNinjaHead.Basemeshesareshown 
infalsecolor,displacementmapsareshowningreyscale. 



Figure9:(a)Renderingoftwodisplacedtriangles,showninfalsecolor.(b)Numberoftraversalstepstoreachanintersection 
forprimaryraysusingthemethodofThonatetal.[2021],visualizedasalog-scaleheatmap.Theinsetrevealsthequad-tree 
natureoftheirtexture-spacetraversal.(c)OurRMIPtraversalrequiresonaverageanorderofmagnitudefeweriterations;for 
fairness,weadditionallycounteachtexelvisitedduringourtexelmarchingasonetraversalstep.Blockypatternsarevisiblein 
theinset,revealingtheRMIPresolution. 



Figure10:Render-timespeed-upofourmethodwithrespecttoTFDM[Thonatetal.2021]withequivalentmemoryconsumption, 
whenscalingthedisplacementmagnitude(left)andtiling(right)beyondthoseoriginallyusedforeachscene.Renderings 
associatedtoeachdisplacementparameterchangeareshownonthesideswiththeAlienSpherescene. 



RMIP:Displacementray-tracingviainversionandoblongbounding 
SAConferencePapersâ€™23,December12â€“15,2023,Sydney,NSW,Australia 



Figure11:Performanceofourmethodatdifferenttexel-marchingscalesontwoscenes(left:ElvenArmor,GPU;right:NinjaHead, 
CPU).WeshowplotsfordifferentRMIPresolutions,andalsoincludeasetupwithourtraversalbutcomputingdisplacement 
boundsusingaminmaxmipmapasinTFDM[Thonatetal.2021].WecompareagainstTFDMasabaseline;itdoesnotsupport 
texelmarching,henceitsflatcurve.Rendertimesarerelativetothebestoneachievedbyourmethod(i.e,yellow-curve 
minimum).ThelegendincludesmemoryconsumptionforeachdatastructurerelativetotheminmaxmipmapusedbyTFDM; 
forRMIPwealsoreportresolutioninpixels.Fastestmarchingscaleforeachsetupishighlightedwithaboldcircle. 



Figure12:Benefitofusingpoint-wisedisplacementinversiononallscenes,fordifferentRMIPresolutions.Weshowrelative 
rendertimebetweeninversionenabledanddisabled(left:GPU;right:CPU;lowerisbetter). 



