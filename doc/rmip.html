<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>RMIP: Displacement ray-tracing via inversion and oblong bounding</title><meta name="description" content="-  Computing methodologies  -&gt;  Rendering."/><style type="text/css"> * {margin:0; padding:0; text-indent:0; }
 .s1 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .h1, h1 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 17pt; }
 .s2 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt; }
 .s5 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s6 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 h3 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .s7 { color: black; font-family:"Lucida Sans Unicode", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s8 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 h2 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 11pt; }
 .p, p { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; margin:0pt; }
 .s9 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s10 { color: black; font-family:"Book Antiqua", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s11 { color: black; font-family:"Gill Sans MT", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s12 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s13 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8pt; }
 .s14 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s15 { color: black; font-family:"Book Antiqua", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s16 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .a, a { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s17 { color: black; font-family:"Book Antiqua", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s18 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7.5pt; vertical-align: -1pt; }
 .s19 { color: black; font-family:"DejaVu Serif Condensed", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s20 { color: #7F7F7F; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s21 { color: #B2B2B2; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s22 { color: black; font-family:"DejaVu Serif Condensed", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s23 { color: black; font-family:"Lucida Sans Unicode", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s24 { color: black; font-family:"Gill Sans MT", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s25 { color: #090; font-family:"Lucida Sans Unicode", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s26 { color: #090; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s27 { color: #090; font-family:"Lucida Sans Unicode", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s28 { color: #090; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s29 { color: #7F7F7F; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 7pt; }
 .s30 { color: #7F7F7F; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 7pt; }
 .s31 { color: #B2B2B2; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 7pt; }
 .s32 { color: black; font-family:"DejaVu Serif Condensed", serif; font-style: italic; font-weight: normal; text-decoration: underline; font-size: 8pt; }
 .s33 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 8pt; }
 .s34 { color: black; font-family:"Lucida Sans Unicode", sans-serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 8pt; }
 .s35 { color: #090; font-family:"Lucida Sans Unicode", sans-serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 7pt; }
 .s36 { color: #090; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 7pt; }
 .s37 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s38 { color: black; font-family:"Gill Sans MT", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s39 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 9pt; vertical-align: 6pt; }
 .s40 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 9pt; vertical-align: 6pt; }
 .s42 { color: black; font-family:"DejaVu Serif Condensed", serif; font-style: italic; font-weight: normal; text-decoration: underline; font-size: 9pt; vertical-align: 6pt; }
 .s43 { color: black; font-family:"DejaVu Serif Condensed", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s44 { color: black; font-family:"Trebuchet MS", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s45 { color: black; font-family:"DejaVu Serif Condensed", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; vertical-align: -7pt; }
 .s46 { color: black; font-family:"Trebuchet MS", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; vertical-align: 7pt; }
 .s47 { color: black; font-family:"DejaVu Serif Condensed", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: -1pt; }
 .s48 { color: black; font-family:"DejaVu Serif Condensed", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: -1pt; }
 .s49 { color: black; font-family:"DejaVu Serif Condensed", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s50 { color: black; font-family:"DejaVu Serif Condensed", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: 3pt; }
 .s51 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: -1pt; }
 .s52 { color: black; font-family:"Lucida Sans", sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s53 { color: black; font-family:"DejaVu Serif Condensed", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: 5pt; }
 .s54 { color: black; font-family:"Trebuchet MS", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; vertical-align: 10pt; }
 .s55 { color: black; font-family:"DejaVu Serif Condensed", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; vertical-align: -5pt; }
 .s56 { color: black; font-family:"DejaVu Serif Condensed", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s57 { color: black; font-family:"DejaVu Serif", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: -1pt; }
 .s58 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: -2pt; }
 .s59 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: 3pt; }
 .s60 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s61 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: 3pt; }
 .s62 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: -2pt; }
 .s63 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: -1pt; }
 .s64 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: -1pt; }
 .s65 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: -2pt; }
 .s66 { color: black; font-family:"DejaVu Serif", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: 3pt; }
 .s67 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: bold; text-decoration: underline; font-size: 8pt; }
 .s68 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 5pt; vertical-align: -1pt; }
 .s69 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8.5pt; }
 .s70 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8.5pt; }
 .s71 { color: black; font-family:"Lucida Sans Unicode", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8.5pt; }
 .s72 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7.5pt; }
 .s73 { color: black; font-family:"Book Antiqua", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8.5pt; }
 h4 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8.5pt; }
 .s74 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 8.5pt; }
 .s76 { color: black; font-family:"Book Antiqua", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8.5pt; }
 .s77 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8.5pt; }
 .s78 { color: black; font-family:"Lucida Sans Unicode", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8.5pt; }
 .s79 { color: black; font-family:"DejaVu Serif Condensed", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8.5pt; }
 .s80 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8.5pt; }
 .s81 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8.5pt; }
 .s82 { color: black; font-family:"Lucida Sans Unicode", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8.5pt; vertical-align: 10pt; }
 .s83 { color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: 3pt; }
 .s84 { color: black; font-family:"Book Antiqua", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; }
 li {display: block; }
 #l1 {padding-left: 0pt; }
 #l1> li>*:first-child:before {content: "â€¢ "; color: black; font-family:"Gill Sans MT", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 li {display: block; }
 #l2 {padding-left: 0pt;counter-reset: d1 3; }
 #l2> li>*:first-child:before {counter-increment: d1; content: counter(d1, decimal)" "; color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 11pt; }
 #l2> li:first-child>*:first-child:before {counter-increment: d1 0;  }
 #l3 {padding-left: 0pt;counter-reset: d2 1; }
 #l3> li>*:first-child:before {counter-increment: d2; content: counter(d1, decimal)"."counter(d2, decimal)" "; color: black; font-family:"Palatino Linotype", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 11pt; }
 #l3> li:first-child>*:first-child:before {counter-increment: d2 0;  }
 table, tbody {vertical-align: top; overflow: visible; }
</style></head><body><p class="s1" style="text-indent: 0pt;line-height: 27pt;text-align: left;"><span><a href="http://crossmark.crossref.org/dialog/?doi=10.1145%2F3610548.3618182&amp;domain=pdf&amp;date_stamp=2023-12-11"><img width="35" height="35" alt="image" src="rmip_files/Image_001.jpg"/></a></span>                                 <span class="h1">RMIP:</span></p><h1 style="padding-left: 67pt;text-indent: 0pt;line-height: 20pt;text-align: left;">Displacement ray-tracing via inversion and oblong bounding</h1><p class="s5" style="padding-top: 8pt;padding-left: 82pt;text-indent: 0pt;line-height: 87%;text-align: center;"><a href="mailto:thonat@adobe.com" class="s2" target="_blank">ThÃ©o Thonat </a>thonat@adobe.com Adobe</p><p class="s6" style="padding-left: 175pt;text-indent: 0pt;line-height: 12pt;text-align: center;">France</p><p class="s5" style="padding-top: 8pt;padding-left: 36pt;text-indent: 0pt;line-height: 87%;text-align: center;"><a href="mailto:igeorgiev@adobe.com" class="s2" target="_blank">Iliyan Georgiev </a>igeorgiev@adobe.com Adobe</p><p class="s6" style="padding-left: 175pt;text-indent: 0pt;line-height: 12pt;text-align: center;">UK</p><p class="s5" style="padding-top: 8pt;padding-left: 35pt;text-indent: 0pt;line-height: 87%;text-align: center;"><a href="mailto:beaune@adobe.com" class="s2" target="_blank">FranÃ§ois Beaune </a>beaune@adobe.com Adobe</p><p class="s6" style="padding-left: 175pt;text-indent: 0pt;line-height: 12pt;text-align: center;">France</p><p class="s5" style="padding-top: 8pt;padding-left: 175pt;text-indent: 0pt;line-height: 87%;text-align: center;"><a href="https://orcid.org/0000-0001-5985-0921" class="s2" target="_blank">Tamy </a><a href="mailto:boubek@adobe.com" class="s2" target="_blank">Boubekeur </a>boubek@adobe.com Adobe</p><p class="s6" style="padding-left: 175pt;text-indent: 0pt;line-height: 12pt;text-align: center;">France</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 53pt;text-indent: 0pt;text-align: left;"><span><img width="673" height="230" alt="image" src="rmip_files/Image_002.jpg"/></span></p><h3 style="padding-top: 2pt;padding-left: 53pt;text-indent: 0pt;line-height: 83%;text-align: justify;"><a name="bookmark0">Figure 1: A scene where most geometric content comes from high-resolution displacement mapping. The base geometry and the 4k displacement maps tiled on it are shown on the right. Our proposed method achieves 11</a><span class="s7">Ã— </span><a href="#bookmark67" class="s8">faster path tracing than TFDM [Thonat et al. </a>2021] while consuming 3<span class="s7">Ã— </span>less memory.</h3><p style="text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-top: 4pt;padding-left: 53pt;text-indent: 0pt;text-align: left;"><a name="bookmark1">ABSTRACT</a></h2><p style="padding-top: 1pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;">High-performance ray tracing of triangle meshes equipped with displacement maps is a challenging task. Existing methods either rely on pre-tessellation, taking full advantage of the hardware but with a poor memory/quality tradeoff, or use custom displacement- centric acceleration structures, preserving all the geometric details but being orders of magnitude slower. We introduce a method that efficiently probes the displacement-map space to find ray-surface intersections without relying on pre-tessellation. Our method com- bines inverse displacement mapping and on-the-fly surface-bound computation. It employs a novel data structure that provides tight displacement bounds over rectangular regions in the displacement- map space. We demonstrate the effectiveness of our approach in a production GPU path tracer. It can achieve over an order of magni- tude speed-up in render time compared to state of the art in the most challenging real-time path-tracing scenarios, while maintaining a low memory footprint.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 53pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="321" height="1" alt="image" src="rmip_files/Image_003.png"/></span></p><p class="s9" style="padding-top: 1pt;padding-left: 53pt;text-indent: 0pt;line-height: 84%;text-align: justify;">Permission to make digital or hard copies of part or all of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. Copyrights for third-party components of this work must be honored. For all other uses, contact the owner/author(s).</p><p class="s10" style="padding-left: 53pt;text-indent: 0pt;line-height: 8pt;text-align: justify;">SA Conference Papers â€™23, December 12â€“15, 2023, Sydney, NSW, Australia</p><p class="s11" style="padding-left: 53pt;text-indent: 0pt;line-height: 84%;text-align: left;">Â© <span class="s9">2023 Copyright held by the owner/author(s). ACM ISBN 979-8-4007-0315-7/23/12.</span></p><p style="padding-left: 53pt;text-indent: 0pt;line-height: 8pt;text-align: left;"><a href="https://doi.org/10.1145/3610548.3618182" class="s12">https://doi.org/10.1145/3610548.3618182</a></p><h2 style="padding-top: 4pt;padding-left: 20pt;text-indent: 0pt;text-align: left;">CCS CONCEPTS</h2><ul id="l1"><li data-list-text="â€¢"><h3 style="padding-left: 25pt;text-indent: -5pt;text-align: left;">Computing methodologies <span class="s7">â†’ </span>Rendering<span class="p">.</span></h3></li></ul><h2 style="padding-top: 6pt;padding-left: 20pt;text-indent: 0pt;text-align: left;">KEYWORDS</h2><p style="padding-left: 20pt;text-indent: 0pt;text-align: justify;">GPU Ray Tracing, Displacement Mapping</p><p class="s13" style="padding-top: 5pt;padding-left: 20pt;text-indent: 0pt;line-height: 10pt;text-align: justify;">ACM Reference Format:</p><p class="s14" style="padding-left: 20pt;text-indent: 0pt;text-align: justify;">ThÃ©o Thonat, Iliyan Georgiev, FranÃ§ois Beaune, and Tamy Boubekeur. 2023. RMIP: Displacement ray-tracing via inversion and oblong bounding. In <span class="s15">SIGGRAPH Asia 2023 Conference Papers (SA Conference Papers â€™23), December 12â€“15, 2023, Sydney, NSW, Australia. </span><a href="#bookmark77" class="s16">ACM, New York, NY, USA, 11</a><a href="https://doi.org/10.1145/3610548.3618182" class="s16" target="_blank"> pages. https://doi.org/10.1145/3610548.3618182</a></p><p style="text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-top: 7pt;padding-left: 20pt;text-indent: 0pt;text-align: left;"><a name="bookmark2">1 INTRODUCTION</a></h2><p style="padding-top: 1pt;padding-left: 20pt;text-indent: 0pt;line-height: 90%;text-align: justify;">Displacement mapping is a powerful mechanism to enrich base 3D meshes with high-frequency details and mesostructures, of- floading most of the resulting representation to a (commonly high- resolution) 2D map providing, for any point of the surface, a dis- placement value. At rendering time, the base geometry is deformed according to the map, to recover the full-resolution shape. As such, large parts of the shape processing and management can be per- formed on the low-resolution base surface, leveraging the random- accessible nature of the displacement map to provide easy level of detail, compression, and filtering. In practice, real-time displace- ment mapping is often made available through rasterization engines,</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 6pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;">where hardware tessellation triggers the displacement process at every frame. Unfortunately, for real-time ray tracing, displacement mapping is typically applied as a preprocess, producing a high- resolution mesh to be maintained during rendering which still suffers from subsampling artifacts in real-world scenarios.</p><p style="padding-left: 53pt;text-indent: 9pt;line-height: 90%;text-align: justify;"><a href="#bookmark61" class="a">Modern GPU architectures offer hardware support for ray trac- ing [Sanzharov et al. 2020],</a> which enables interactive physically- based rendering based on Monte Carlo integration, in an aim to bridge the gap between real-time and offline rendering. Primarily designed for triangle meshes, this new programmable GPU pipeline draws its efficiency from an underlying acceleration structure (AS), organized in a top-level component (TLAS) and a bottom level one (BLAS). However, such bounding volume hierarchies require explicit realization of the high-resolution geometry, i.e., after tessel- lation and displacement, which quickly fails at reproducing accu- rately complex displacement maps over arbitrary macro domains, entails a large memory footprint, is intractable when the displace- ment content is dynamic, and may ultimately not be possible when tiling the displacement over the domain.</p><p class="s7" style="text-indent: 0pt;line-height: 11pt;text-align: left;">Ã—</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 53pt;text-indent: 10pt;line-height: 90%;text-align: justify;"><a href="#bookmark67" class="a">Tessellation-free displacement mapping (TFDM) has been re- cently proposed as an alternative to explicit displacement mesh- ing [Thonat et al. 2021].</a><a href="#bookmark0" class="a"> It achieves full accuracy but exhibits limited execution performance. We tackle this problem by introducing a new data structure, dubbed RMIP, which allows to quickly discover the displacement map subregions that are likely to intersect a ray. It supports subregions with rectangular shape, enabling the propa- gation of tight bounds between the 2D displacement space and the 3D ray space, to quickly narrow down the search for intersection in a front-to-back manner. By often reducing the number of traversal steps by over an order of magnitude, our method can achieve a speed-up of 10  or more over TFDM, while preserving full accu- racy (see Fig. 1)</a> and remaining orthogonal to both the hardware TLAS/BLAS traversal and the final ray-surface intersection test.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 53pt;text-indent: 0pt;text-align: left;"><a name="bookmark3">2 PREVIOUS WORK</a></h2><p class="s17" style="padding-top: 1pt;padding-left: 53pt;text-indent: 9pt;line-height: 90%;text-align: justify;">Ray-traced displacement maps. <a href="#bookmark54" class="a">Offline rendering of scenes with complex geometry sparked many extensions of the Reyes archi- tecture, driven by caching and ray reordering [Christensen et al. 2003].</a><a href="#bookmark41" class="a"> Lazy building of local accelerations structures was explored by Hunt et al. [2007].</a><a href="#bookmark36" class="a"> Hanika et al. [2010]</a><a href="#bookmark37" class="a"> extended it to two-level acceleration structures, where the lower levels are populated by structures resulting from on-demand surface tessellation. A similar scheme has been used in the context of vector displacement map- ping [Harada 2015].</a><span class="p"> Performance in these setups critically depends on ray reordering to maximize the reuse of the local structures. In contrast, we use an implicit acceleration structure unique to each ray, generating the micro-structure only at the scale of the displacement texels, thus free of ray reordering constraints.</span></p><p style="padding-left: 53pt;text-indent: 9pt;line-height: 90%;text-align: justify;"><a href="#bookmark31" class="a">The Razor system [Djeu et al. 2011]</a> allows each ray to indepen- dently choose its appropriate geometric resolution. It relies on lazy evaluation and caching of local tessellations at discrete levels of detail (LoDs) that are interpolated at intersection time to generate fractional LoDs. Our per-ray traversal structure allows intersecting the displaced surface directly at fractional LoDs, since we generate the surface explicitly only during the final steps of the traversal.</p><p class="s17" style="padding-top: 6pt;padding-left: 20pt;text-indent: 10pt;line-height: 90%;text-align: justify;">Real-time displacement mapping. <a href="#bookmark42" class="a">In the context of rasterization, numerous methods have been proposed to render surface details in real time without tessellation. In particular, probing a height map to find approximate intersections with the meso-surface has been extensively studied. Parallax mapping [Kaneko et al. </a><a href="#bookmark65" class="a">2001; Tatarchuk 2006]</a><a href="#bookmark72" class="a"> offsets the intersection in texture space based on the height content. Sampling the height field using ray-marching allows finding a pair of points above and below the surface, which is the starting point for several refinement methods, for example using the secant method [Yerex and JÃ¤gersand 2004],</a><a href="#bookmark59" class="a"> using binary search with relief mapping [Policarpo et al. 2005],</a><a href="#bookmark51" class="a"> or using a minmax texture [Lee et al. 2009].</a><a href="#bookmark38" class="a"> Height maps can also be pre-processed to encode empty space near the surface, allowing to safely ray-march with adaptive steps. Numerous safety shapes has been proposed, such as spheres [Hart 1996;</a><a href="#bookmark32" class="a"> Donnelly 2005],</a><a href="#bookmark33" class="a"> cones [Dummer </a><a href="#bookmark58" class="a">2006; Policarpo and Oliveira 2007],</a><a href="#bookmark46" class="a"> and cylinders [Baboud et al. </a><a href="#bookmark64" class="a">2011]. An in-depth overview of meso-surface real-time rendering can be found in the survey of Szirmay-Kalos et al. [2009].</a><span class="p"> All those methods approximate the tangent space by a locally flat height field. This makes the rendered surface view-dependent when the base surface has curvature, making those methods unsuitable for our ray tracing context.</span></p><p style="padding-left: 20pt;text-indent: 10pt;line-height: 90%;text-align: justify;"><a href="#bookmark70" class="a">Another type of approaches consists in pre-computing intersec- tions with the meso-surface from a dense sampling of query rays and compressing them in a suitable way for real time rendering. Early methods rely on singular value decomposition [Wang et al. 2003,</a><a href="#bookmark71" class="a"> 2004];</a><a href="#bookmark47" class="a"> recent works use a small set of neural nets with spatially variant weights, stored in textures, and mapped onto a bounding volume [Kuznetsov et al. </a><a href="#bookmark49" class="a">2021, </a>2022]. Although such methods han- dle a variety of meso-geometries beyond scalar displacement, their encoding requires expensive pre-processing, with rendering quality proportional to the memory consumption. In contrast, our method requires minimal pre-processing and storage, while preserving the full geometric and visual complexity of the displacement content.</p><p class="s17" style="padding-top: 5pt;padding-left: 20pt;text-indent: 10pt;line-height: 90%;text-align: justify;">Inverse mappings. <a href="#bookmark60" class="a">Mapping the vicinity of a 3D surface back to its texture space allows transforming ray tracing of complex, possibly volumetric, meso-structures to simpler 2D tracing. In the context of shell mapping, Porumbescu et al. [2005]</a><a href="#bookmark43" class="a"> create a thin vol- umetric layer around the surface by extruding the mesh outward in the normal directions. Rays intersecting this volume can be mapped to texture space, where traditional real-time height-field-marching techniques can be applied, although inheriting their shortcomings. Since the mapping from world to texture space is non-linear, special care is required to handle the tracing of curved ray paths to avoid missing intersections from the height field [Jeschke et al. </a><a href="#bookmark57" class="a">2007]. In the context of displacement mapping, Patterson et al. </a><a href="#bookmark52" class="a">[1991] project intersections between the ray and a bounding volume back to texture space following the directions of displacement. They use these projected intersections to conservatively track the ray in texture space which greatly reduces the search region for in- tersection. Their method, and its extension [Logie and Patterson 1995],</a><span class="p"> is limited to a number of analytical base surfaces; we utilize this mapping and extend inverse displacement mapping to triangle meshes.</span></p><p class="s17" style="padding-top: 6pt;padding-left: 20pt;text-indent: 9pt;line-height: 90%;text-align: justify;">Implicit acceleration structures for ray tracing. <span class="p">The memory bur- den of accelerating the ray tracing of highly detailed geometry has</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 53pt;text-indent: 0pt;text-align: left;"><span><img width="677" height="170" alt="image" src="rmip_files/Image_004.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s18" style="padding-left: 77pt;text-indent: 0pt;line-height: 8pt;text-align: left;"><span><img width="37" height="10" alt="image" src="rmip_files/Image_005.png"/></span>	<span><img width="78" height="10" alt="image" src="rmip_files/Image_006.png"/></span>	<span><img width="113" height="10" alt="image" src="rmip_files/Image_007.png"/></span>	<span><img width="178" height="10" alt="image" src="rmip_files/Image_008.png"/></span></p><h3 style="padding-top: 2pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a name="bookmark4">Figure 2: Overview of our method. (a) The input is a triangle mesh and a displacement map. (b) We first pre-process the map into our novel RMIP data structure that stores minmax displacement bounds over rectangular regions in texture space. (c) Once the displacement is mapped onto the triangle mesh according to the displacement parameters, a tight bounding prism for the displaced surface within each base triangle is computed, and all prisms are organized into a static bounding volume hierarchy.</a></h3><h3 style="padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a href="#bookmark6" class="s8">(d) At ray-tracing time, any intersection between a ray and a bounding prism triggers our custom traversal, which ping-pongs between 2D ray bounds in texture space and 3D displacement bounds in object space to tighten the interval of potential intersection in a hierarchical fashion (see Fig.</a> 3). Once the 2D bounds are small enough, we switch to a texel-marching process, generating and intersecting micro-geometry on-the-fly along the ray.</h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 7pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a href="#bookmark39" class="a">lead to the development of implicit acceleration structures. Simi- larly to our work, Heidrich and Seidel [1998]</a><a href="#bookmark63" class="a"> use affine arithmetic to estimate 3D bounds in the context of procedural shaders with analytical base surfaces and displacement. The work of Smits et al. [2000]</a><a href="#bookmark55" class="a"> allows ray tracing of displaced triangle meshes without tes- sellation, marching through bounding prisms defined from the base triangle barycentric space. We also use bounding prisms and linear marching, although we apply them only at specific steps of our traversal. Bounding prisms and barycentric grids were also used by Maggiordomo et al. [2023]</a><a href="#bookmark4" class="a"> to efficiently compress displacement content, in a way that can be ray-traced with hardware support without pre-tessellation. In our case, base triangles generally do not coincide with faces of the bounding prisms (see Fig.</a> 2).</p><p style="padding-left: 53pt;text-indent: 9pt;line-height: 90%;text-align: justify;"><a href="#bookmark53" class="a">Carr et al. [2006]</a> use minmax mipmaps to efficiently ray-trace geometry images, building an implicit quad-tree bounding volume hierarchy in <span class="s19">ğ‘¢ğ‘£ </span><a href="#bookmark56" class="a">space. Similarly, the work of Oh et al. [2006],</a><a href="#bookmark66" class="a"> later im- proved by Tevs et al. </a>[2008], use a maximum displacement mipmap as an implicit hierarchical data structure, restricted to height fields on planar surfaces.</p><p style="padding-left: 53pt;text-indent: 10pt;line-height: 90%;text-align: justify;"><a href="#bookmark67" class="a">Most relevant to our work is the tessellation-free displacement mapping (TFDM) method of Thonat et al. [2021].</a> They use a minmax mipmap both to locally bound the displacement and as an accelera- tion structure for ray traversal in texture space. Displaced-surface bounds are generated on-the-fly from the quad-tree nodes using affine arithmetic and tested against the ray. Analytic ray-surface intersection is performed upon reaching a texel-sized node. TFDM supports fractional LoD and displacement tiling, and achieves great pre-computation and memory savings. Unfortunately, these sav- ings come at the cost of substantial computational burden during rendering due to loose bounds and inefficient space culling leading to long traversals. Our work addresses these shortcomings to sig- nificantly improve performance without sacrificing the benefits of TFDM.</p><ol id="l2"><li data-list-text="3"><h2 style="padding-top: 4pt;padding-left: 36pt;text-indent: -16pt;text-align: left;"><a name="bookmark5">OUR METHOD</a></h2><p style="padding-top: 1pt;padding-left: 20pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a href="#bookmark67" class="a">We propose a method for direct ray tracing against a triangle mesh displaced by a scalar texture map, avoiding the explicit displacement of a fine pre-tessellation. Ray-geometry intersection algorithms op- erate by iteratively shrinking the interval along the ray through space culling, typically by traversing the ray through a spatial struc- ture that bounds the geometry at multiple scales. Maintaining tight bounds is key to achieving good performance as it minimizes the number of costly traversal steps required to descend to a scale where analytic intersection testing is possible. Tessellation-free displacement mapping (TFDM) [Thonat et al. 2021]</a> operates in tex- ture space, traversing a minmax mipmap quad-tree. While simple, this scheme suffers from slow interval tightening and long traver- sal, for three reasons: (1) The tree structure is fixedâ€”it does not depend on the displacement data; (2) The texture-space footprint (i.e., projection) of a ray segment is generally anisotropic but the tree nodes only provide conservative displacement bounds over square-shaped regions; (3) Hierarchy pruning is solely based on a simple binary (yes/no) feedback from the intersections of the loose 3D-box bounds derived from the nodes.</p><p style="padding-left: 20pt;text-indent: 10pt;line-height: 90%;text-align: justify;"><a href="#bookmark6" class="a">The main idea behind our method is to track tight ray-interval bounds simultaneously in 2D texture space and 3D object space. It is inspired by the observation that each space has access to unique information that can be leveraged to effectively tighten the bound in the other space: Subdividing a 2D ray bound (i.e., a region in texture space bounding the curved ray projection) yields tighter scalar displacement bounds and thus tighter 3D-surface bounds. In- tersecting those 3D bounds then tightens the valid ray interval and shrinks its 2D footprint. This ping-pong scheme can tighten bounds rapidly and thus speed up space culling to reduce the number of tra- versal steps; Fig. 3</a><a href="#bookmark57" class="a"> shows an illustration in flatland. Patterson et al. [1991]</a> explored the scheme for analytical base surfaces; we extend it to triangle meshes with interpolated displacement directions.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="324" height="115" alt="image" src="rmip_files/Image_009.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="1" height="7" alt="image" src="rmip_files/Image_010.png"/></span></p><h3 style="padding-top: 2pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a name="bookmark6">Figure 3: Overview of our traversal algorithm which ping- pongs between 2D and 3D to iteratively tighten the ray inter- val of potential intersection. (a) For a given initial bound (1) in the 2D displacement-texture space, we compute displace- ment bounds to obtain a 3D box around the displaced surface. Projecting the ray-box intersection interval back into texture space yields a reduced 2D bound (2). (b) This ray-bounding region (2) is then subdivided into two subregions (3) which in turn yield tighter 3D bounds. (c) The ray interval of the first intersected box is projected back onto 2D as in step (a), and the process repeats by feeding the obtained tighter 2D bound (4) to step (b).</a></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s7" style="text-indent: 0pt;line-height: 11pt;text-align: left;">â†’</p><p style="text-indent: 0pt;text-align: left;"/><p class="s7" style="text-indent: 0pt;line-height: 11pt;text-align: left;">â†’</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 53pt;text-indent: 10pt;line-height: 90%;text-align: justify;"><a href="#bookmark67" class="a">For the above-described scheme to be effective, we need to not only map 2D ray-interval bounds to 3D geometry bounds but also 3D ray-intersection intervals back to 2D. For the 2D  3D mapping, we employ affine arithmetic as Thonat et al. [2021].</a> For the 3D  2D mapping, we use displacement inversion to project the endpoints of ray-intersection intervals to axis-aligned bounds in texture space. These 2D bounds can have highly anisotropic rectangular shapes; conservatively snapping them to the predefined square-shaped nodes of a minmax mipmap would yield valid but excessively loose bounds for the displacement inside them. To that end, we intro- duce a novel data structure, dubbed <span class="s17">rectangular minmax image pyramid (RMIP)</span>, that provides displacement bounds for arbitrary axis-aligned rectangular regions in texture space. Crucially, RMIP divorces us from rigid traversal hierarchies and liberates us to cull space efficiently based on the specific ray-triangle configuration.</p><p style="padding-top: 6pt;padding-left: 53pt;text-indent: 10pt;line-height: 90%;text-align: justify;"><a href="#bookmark4" style=" color: black; font-family:&quot;Book Antiqua&quot;, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt;">Algorithm overview. </a><a href="#bookmark4" class="a">Figure 2</a> illustrates our method. Given a triangle mesh equipped with per-vertex displacement normals and a displacement texture, we first construct the RMIP structure which stores scalar displacement bounds over rectangles of various size and shape in texture space. Then for each triangle we compute a prism that tightly bounds the displaced 3D surface arising from it; we build a bounding volume hierarchy over all prisms.</p><p style="padding-left: 53pt;text-indent: 9pt;line-height: 90%;text-align: justify;"><a href="#bookmark7" class="a">During ray tracing, each intersected prism triggers our per- triangle traversal algorithm, laid out in Alg. 1.</a><a href="#bookmark6" class="a"> It first projects the ray-prism intersection interval to texture space. This 2D projection is a curve which may need to be split into sub-curves so that each can be bounded by the axis-aligned rectangle spanned by its end- points; the bounding rectangles are pushed to a stack. The traversal loop then pops rectangular bounds from the stack and alternates be- tween (1) computing 3D-surface bounds from displacement bounds over rectangles and intersecting them (Fig. 3a), and (2) projecting the 3D ray-intersection intervals and subdividing the rectangles that bound them (Fig.</a> 3b). When the current 2D bound becomes small enough, we switch to marching along the displacement texels it spans, locally reconstructing the displaced 3D surface for each</p><h3 style="padding-top: 5pt;padding-left: 20pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a name="bookmark7">Algorithm 1: Pseudo-code of our displacement intersection algorithm which iteratively tightens ray bounds in both 2D texture space and 3D object space, using our RMIP structure.</a></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 20pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="317" height="1" alt="image" src="rmip_files/Image_011.png"/></span></p><p class="s14" style="padding-left: 24pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span class="s20">1</span><span class="s21">: </span><b>function </b>IntersectRMIP(<span class="s22">ğ‘Ÿğ‘ğ‘¦</span>, <span class="s22">ğ‘¡ğ‘Ÿğ‘–ğ‘ğ‘›ğ‘”ğ‘™ğ‘’</span>, <span class="s22">ğ‘ğ‘Ÿğ‘–ğ‘ ğ‘š</span>, <span class="s22">ğ‘Ÿğ‘šğ‘–ğ‘</span>)</p><p class="s23" style="text-indent: 0pt;line-height: 10pt;text-align: left;">(   (    ) )</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-left: 24pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span class="s20">2</span><span class="s21">:  </span>ğ‘ğ‘œğ‘–ğ‘›ğ‘¡ğ‘  <span class="s24">= </span><span class="s14">sort intersect </span>ğ‘Ÿğ‘ğ‘¦, ğ‘ğ‘Ÿğ‘–ğ‘ ğ‘š</p><p class="s23" style="text-indent: 0pt;line-height: 10pt;text-align: left;">(      )  <span class="s25">â†</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s20" style="padding-left: 24pt;text-indent: 0pt;line-height: 10pt;text-align: left;">3<span style=" color: #B2B2B2;">:  </span><span class="s22">ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ğ‘  </span><span class="s24">= </span><span class="s14">inverse displacement </span><a href="#bookmark15" style=" color: black; font-family:&quot;DejaVu Serif Condensed&quot;, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt;">ğ‘ğ‘œğ‘–ğ‘›ğ‘¡ğ‘ , ğ‘¡ğ‘Ÿğ‘–ğ‘ğ‘›ğ‘”ğ‘™ğ‘’   </a><a href="#bookmark15" class="s26">Section 4.1</a></p><p class="s23" style="text-indent: 0pt;line-height: 10pt;text-align: left;">(    ) <span class="s25">â†</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-left: 24pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span class="s20">4</span><span class="s21">:  </span>ğ‘¡ğ‘¢ğ‘Ÿğ‘›ğ‘–ğ‘›ğ‘” ğ‘ğ‘œğ‘–ğ‘›ğ‘¡ğ‘  <span class="s24">= </span><span class="s14">zero </span>ğ‘¢ğ‘£ <span class="s14">derivative </span><a href="#bookmark18" style=" color: black; font-family:&quot;DejaVu Serif Condensed&quot;, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt;">ğ‘Ÿğ‘ğ‘¦, ğ‘¡ğ‘Ÿğ‘–ğ‘ğ‘›ğ‘”ğ‘™ğ‘’  </a><a href="#bookmark18" class="s26">Section 4.2</a></p><p class="s23" style="text-indent: 0pt;line-height: 10pt;text-align: left;">()</p><p style="text-indent: 0pt;text-align: left;"/><p class="s27" style="text-indent: 0pt;line-height: 9pt;text-align: left;">â†</p><p style="text-indent: 0pt;text-align: left;"/><p class="s23" style="text-indent: 0pt;line-height: 10pt;text-align: left;">(          )     <span class="s25">â†</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-left: 24pt;text-indent: 0pt;line-height: 92%;text-align: justify;"><span class="s20">5</span><span class="s21">:  </span>ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ğ‘  <span class="s24">= </span><span class="s14">split </span><a href="#bookmark18" style=" color: black; font-family:&quot;DejaVu Serif Condensed&quot;, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt;">ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ğ‘ , ğ‘¡ğ‘¢ğ‘Ÿğ‘›ğ‘–ğ‘›ğ‘” ğ‘ğ‘œğ‘–ğ‘›ğ‘¡ğ‘        </a><a href="#bookmark18" class="s26">Section </a><span class="s28">4.2 </span><span class="s20">6</span><span class="s21">:  </span><span class="s13">while </span>ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ğ‘  <span class="s13">is not </span><span class="s14">empty </span><span class="s13">do      </span><span class="s28">Stack of 2D ray bounds </span><span class="s20">7</span><span class="s21">:   </span>ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ <span class="s24">= </span>ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ğ‘ .<span class="s14">pop</span></p><p class="s22" style="padding-left: 24pt;text-indent: 0pt;line-height: 10pt;text-align: justify;"><span class="s20">8</span><span class="s21">:   </span><span class="s13">if </span>ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ <span class="s14">is smaller than </span>ğ‘šğ‘ğ‘Ÿğ‘â„ğ‘–ğ‘›ğ‘” ğ‘ ğ‘ğ‘ğ‘™ğ‘’ <span class="s13">then</span></p><p class="s27" style="text-indent: 0pt;line-height: 9pt;text-align: left;">â†</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 24pt;text-indent: 0pt;line-height: 10pt;text-align: justify;"><span class="s20">9</span><span class="s21">:    </span>for <span class="s22">ğ‘¡ğ‘’ğ‘¥ğ‘’ğ‘™ </span>in <span class="s14">texel marching(</span><span class="s22">ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘</span><span class="s14">) </span><a href="#bookmark21" style=" color: black; font-family:&quot;Palatino Linotype&quot;, serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8pt;">do     </a><a href="#bookmark21" class="s26">Section 4.3</a></p><p class="s22" style="padding-left: 21pt;text-indent: 0pt;line-height: 10pt;text-align: justify;"><span class="s20">10</span><span class="s21">:    </span><span class="s13">if </span>â„ğ‘–ğ‘¡ <span class="s14">= displaced surface intersect(</span>ğ‘Ÿğ‘ğ‘¦<span class="s14">, </span>ğ‘¡ğ‘’ğ‘¥ğ‘’ğ‘™ <span class="s14">) </span><span class="s13">then</span></p><p class="s23" style="text-indent: 0pt;line-height: 10pt;text-align: left;">(  )</p><p style="text-indent: 0pt;text-align: left;"/><p class="s23" style="text-indent: 0pt;line-height: 10pt;text-align: left;">)  <span class="s25">â†</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-left: 21pt;text-indent: 0pt;line-height: 94%;text-align: justify;"><span class="s20">11</span><span class="s21">:      </span><span class="s13">return </span>â„ğ‘–ğ‘¡  <span class="s27">â† </span><span class="s28">Front-to-back traversal, terminate on first hit </span><span class="s20">12</span><span class="s21">:   </span>ğ‘ğ‘œğ‘¥ <span class="s24">= </span><span class="s14">surface bounds(</span><a href="#bookmark23" style=" color: black; font-family:&quot;DejaVu Serif Condensed&quot;, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt;">ğ‘¡ğ‘Ÿğ‘–ğ‘ğ‘›ğ‘”ğ‘™ğ‘’, ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘, ğ‘Ÿğ‘šğ‘–ğ‘     </a><a href="#bookmark23" class="s26">Section </a><span class="s28">5 </span><span class="s20">13</span><span class="s21">:   </span><span class="s13">if not </span>â„ğ‘–ğ‘¡ğ‘  <span class="s24">= </span><span class="s14">intersect </span>ğ‘Ÿğ‘ğ‘¦, ğ‘ğ‘œğ‘¥ <span class="s13">then</span></p><p class="s20" style="padding-left: 21pt;text-indent: 0pt;line-height: 10pt;text-align: justify;">14<span style=" color: #B2B2B2;">:   </span><span class="s13">continue</span></p><p class="s22" style="padding-left: 21pt;text-indent: 0pt;line-height: 11pt;text-align: left;"><span class="s20">15</span><span class="s21">:   </span>ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ <span class="s24">= </span><span class="s14">reduce</span><span class="s23">(</span>ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘, â„ğ‘–ğ‘¡ğ‘  <span class="s23">)        </span><a href="#bookmark20" style=" color: #090; font-family:&quot;Lucida Sans Unicode&quot;, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt;">â† </a><a href="#bookmark20" class="s26">Section 4.3</a></p><p class="s13" style="padding-left: 21pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span class="s20">16</span><span class="s21">:   </span>for <span class="s22">ğ‘“ ğ‘Ÿğ‘œğ‘›ğ‘¡, ğ‘ğ‘ğ‘ğ‘˜ </span>in <span class="s14">split</span><span class="s23">(</span><span class="s22">ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ </span><span class="s23">) </span>do       <a href="#bookmark21" style=" color: #090; font-family:&quot;Lucida Sans Unicode&quot;, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt;">â† </a><a href="#bookmark21" class="s26">Section 4.3</a></p><p class="s32" style="padding-left: 20pt;text-indent: 0pt;line-height: 11pt;text-align: left;"><span class="s29"> </span><span class="s30">17</span><span class="s31">: &nbsp;&nbsp; </span>ğ‘ğ‘œğ‘¢ğ‘›ğ‘‘ğ‘ <span class="s33">.push</span><span class="s34">(</span>ğ‘ğ‘ğ‘ğ‘˜, ğ‘“ ğ‘Ÿğ‘œğ‘›ğ‘¡ <span class="s34">)  </span><span class="s35">â† </span><span class="s36">Back first so front is pop earlier</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 13pt;padding-left: 19pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a href="#bookmark67" class="a">texel and testing it for intersections. Unlike TFDM [Thonat et al. 2021],</a> thanks to traversing in a front-to-back manner along the ray, we can terminate as soon as we find an intersection.</p><p style="padding-left: 20pt;text-indent: 9pt;line-height: 90%;text-align: justify;"><a href="#bookmark4" class="a">Using bounding prisms provides a good compromise between intersection complexity and tightness, especially since it achieves space subdivisionâ€”the displaced-surface bounds of neighboring triangles do not overlap in 3D (see Fig.</a><a href="#bookmark13" class="a"> 2c). In the supplemental document we discuss the geometry of the prisms, how to construct them, and how to intersect them to obtain the initial bounds for the traversal. An even more important advantage of using prisms over axis-aligned 3D boxes is the guarantee that every 3D location inside them can be successfully projected to texture space. We discuss this aspect in Section 4</a><a href="#bookmark23" class="a"> below; there, we also formally describe our rectangular texture-space ray bounds, how our traversal tightens those bounds iteratively, and how we perform texel marching. In Section 5</a><a href="#bookmark27" class="a"> we present our novel RMIP data structure that provides tight scalar displacement bounds over rectangles in texture space. In Section 6</a> we present results of our method, along with an ablation study around different traversal components.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="4"><h2 style="padding-left: 36pt;text-indent: -16pt;text-align: left;"><a name="bookmark8">TEXTURE-SPACE TRAVERSAL</a><a name="bookmark13">&zwnj;</a></h2><p style="padding-top: 1pt;padding-left: 19pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a href="#bookmark4" class="a">Obtaining the tightest possible displacement bounds along a ray requires the ability to track its projection in 2D texture space. This projectionâ€”along the displacement-direction field defined by the interpolated vertex normalsâ€”is a curve (see Fig.</a> 2d), and deriving an explicit 1D parametrization for it is difficult. Luckily, a simple implicit form for the curve is easy to obtain. That form, in combi- nation with point-wise displacement inversion, allows us to bound the curve using axis-aligned rectangles. Below we describe how we project the endpoints of 3D ray intervals to 2D locations and how we derive tight curve-bounding rectangles from them using the implicit form. We also show how to use that form to subdivide those bounds and to march along the exact displacement texels crossed by the ray.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 53pt;text-indent: 0pt;text-align: left;"><span><img width="213" height="134" alt="image" src="rmip_files/Image_012.png"/></span>	<span><img width="93" height="91" alt="image" src="rmip_files/Image_013.png"/></span></p><p style="padding-top: 2pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a href="#bookmark17" class="s8" name="bookmark14">Figure 4: Number of steps required for projecting 3D points onto a base triangle by numerically inverting Eq. (2)</a><a href="#bookmark15" class="s8"> (lower is better), visualized here in false color for 3D locations on a plane orthogonal to the base triangle. Not all 3D points can be successfully projected; however, we only deal with points located inside a prism around the triangle, and these are guaranteed to fall inside the triangle (see Section 4.1).</a></p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l3"><li data-list-text="4.1"><h2 style="padding-left: 78pt;text-indent: -24pt;text-align: left;"><a name="bookmark9">Point-wise inversion</a><a name="bookmark15">&zwnj;</a></h2><p class="s7" style="padding-left: 53pt;text-indent: 0pt;line-height: 12pt;text-align: justify;"><span class="p">A triangle with linearly interpolated positions </span><span class="s37">P</span>(<span class="s19">ğ‘¢, ğ‘£</span>) <span class="p">and normals</span></p><p class="s7" style="padding-left: 53pt;text-indent: 0pt;line-height: 12pt;text-align: justify;"><span class="s37">N</span>(<span class="s19">ğ‘¢, ğ‘£</span>) <span class="p">at texture coordinates </span><span class="s19">ğ‘¢ğ‘£ </span><span class="p">maps texture space to a 3D surface</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="325" height="147" alt="image" src="rmip_files/Image_014.png"/></span></p><h3 style="padding-left: 19pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a href="#bookmark57" class="s8" name="bookmark16">Figure 5: Our traversal narrows down the search along the ray by tightening its 2D bound in two ways. (a) Projecting the endpoints of the 3D-bound intersection interval to texture space can yield a tighter 2D bound. (b) Additionally project- ing the intervalâ€™s midpoint [Patterson et al. 1991]</a> allows subdividing the 2D bound but yields unbalanced traversals and suboptimal space culling. (c) We instead directly split the 2D bound in the middle, with a number of advantages: it is faster, culls half the bound area, yields a more balanced traversal, and bounds the number of traversal steps.</h3><p class="s7" style="padding-left: 109pt;text-indent: 0pt;line-height: 9pt;text-align: left;"><span class="s37">S</span>(<span class="s19">ğ‘¢, ğ‘£</span>) <span class="s38">= </span><span class="s37">P</span>(<span class="s19">ğ‘¢, ğ‘£</span>) + <span class="s19">â„</span>(<span class="s19">ğ‘¢, ğ‘£</span>) <span class="s39">&nbsp;</span><span class="s40">N</span><u>(</u><span class="s42">ğ‘¢, ğ‘£</span><u>)</u></p><p style="padding-top: 6pt;padding-left: 53pt;text-indent: 0pt;line-height: 3pt;text-align: right;">(1)</p><p style="padding-top: 4pt;padding-left: 175pt;text-indent: 0pt;line-height: 5pt;text-align: center;">This is a quadric in texture space with partial derivatives</p><p class="s38" style="text-indent: 0pt;line-height: 10pt;text-align: left;">=</p><p style="text-indent: 0pt;text-align: left;"/><p class="s43" style="text-indent: 0pt;line-height: 7pt;text-align: left;">ğ‘¢</p><p style="text-indent: 0pt;text-align: left;"/><p class="s43" style="text-indent: 0pt;line-height: 7pt;text-align: left;">ğ‘¢</p><p style="text-indent: 0pt;text-align: left;"/><p class="s19" style="text-indent: 0pt;line-height: 12pt;text-align: left;">, <span class="p">(4)</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s7" style="padding-top: 2pt;padding-left: 53pt;text-indent: 0pt;text-align: right;">âˆ¥<span class="s37">N</span>(<span class="s19">ğ‘¢, ğ‘£</span>) âˆ¥</p><p class="s44" style="padding-top: 4pt;padding-left: 53pt;text-indent: 0pt;line-height: 86%;text-align: right;">r<span class="s45">ğœ“ </span>l</p><p class="s7" style="padding-top: 4pt;padding-left: 9pt;text-indent: 0pt;line-height: 16pt;text-align: left;"><span class="s46">r</span><span class="p">det </span>(<span class="s37">P </span><span class="s19">, </span><span class="s37">N</span>(<span class="s19">ğ‘¢, ğ‘£</span>)<span class="s19">, </span><span class="s37">D</span>) + <span class="p">det </span>(<span class="s37">P</span>(<span class="s19">ğ‘¢, ğ‘£</span>) âˆ’ <span class="s37">O</span><span class="s19">, </span><span class="s37">N </span><span class="s19">, </span><span class="s37">D</span>)<span class="s46">l</span></p><p style="text-indent: 0pt;text-align: left;">which is a result of displacing <span class="s37">P </span>by an amount <span class="s19">â„ </span>in the direction <span class="s37">N</span>.</p><p style="text-indent: 0pt;text-align: left;"/><p class="s43" style="text-indent: 0pt;line-height: 7pt;text-align: left;">ğ‘¢</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-top: 6pt;padding-left: 53pt;text-indent: 0pt;line-height: 8pt;text-align: left;"><a href="#bookmark6" class="a">The displacement lines are depicted in Fig.</a> 3a. Projecting a point</p><p class="s7" style="padding-left: 44pt;text-indent: 0pt;text-align: left;"><span class="s19">ğœ“</span><span class="s47">ğ‘£   </span><span class="p">det </span>(<span class="s37">P</span><span class="s48">ğ‘£</span><span class="s49">, </span><span class="s37">N</span>(<span class="s19">ğ‘¢, ğ‘£</span>)<span class="s19">, </span><span class="s37">D</span>) + <span class="p">det </span>(<span class="s37">P</span>(<span class="s19">ğ‘¢, ğ‘£</span>) âˆ’ <span class="s37">O</span><span class="s19">, </span><span class="s37">N</span><span class="s48">ğ‘£</span><span class="s49">, </span><span class="s37">D</span>)</p><p class="s7" style="text-indent: 0pt;line-height: 11pt;text-align: left;">+</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-top: 3pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><span class="s37">O </span><span class="s19">ğ‘¡ </span><span class="s37">D </span>at distance <span class="s19">ğ‘¡ </span>along a ray with origin <span class="s37">O </span>and direction <span class="s37">D </span>into texture space requires inverting this mapping. That is, we look for the <span class="s19">ğ‘¢ğ‘£ </span>coordinates whose displacement line intersects the point:</p><p class="s7" style="padding-top: 3pt;padding-left: 53pt;text-indent: 0pt;text-align: right;"><a name="bookmark17">(</a><span class="s37">P</span>(<span class="s19">ğ‘¢, ğ‘£</span>) âˆ’ (<span class="s37">O </span>+ <span class="s19">ğ‘¡ </span><span class="s37">D</span>)) Ã— <span class="s37">N</span>(<span class="s19">ğ‘¢, ğ‘£</span>) <span class="s38">= </span><span class="s37">0</span><span class="s19">.     </span><span class="p">(2)</span></p><p style="padding-top: 3pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a href="#bookmark43" class="a">Note that this is a vector equation. In the context of shell mapping, Jeschke et al. [2007]</a> provided an analytic inverse of it, as a (scalar) cubic equation w.r.t. the ray parameter <span class="s19">ğ‘¡ </span><a href="#bookmark17" class="a">. However, we found out that an iterative Newton-based numerical inversion of Eq. (2)</a><a href="#bookmark14" class="a"> is both faster and more stable. As seen in Fig. 4,</a> a few iterations are typically sufficient to reach convergence.</p><p style="padding-left: 53pt;text-indent: 9pt;line-height: 90%;text-align: justify;"><a href="#bookmark14" class="a">Figure 4</a> also shows that the displacement inverse is not defined for every 3D point. The key advantage of using a prism as a 3D bounding primitive over a simple axis-aligned box is that it is fully contained inside the convergence region, providing the guarantee that all our projections will fall inside the base triangle.</p></li><li data-list-text="4.2"><h2 style="padding-top: 7pt;padding-left: 78pt;text-indent: -24pt;text-align: justify;"><a name="bookmark10">Implicit ray projection</a><a name="bookmark18">&zwnj;</a></h2><p style="padding-top: 1pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;">We now have the ability to project the endpoints of a ray interval to texture space. The rectangle spanned by these projections will bound the 2D-interval curve if the curveâ€™s partial derivatives w.r.t.</p><p class="s19" style="padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;">ğ‘¢ <span class="p">and </span>ğ‘£ <a href="#bookmark57" class="a">are non-zero, i.e., if the curve does not change its principal direction inside the rectangle, as shown by Patterson et al. </a><a href="#bookmark17" class="a">[1991]. We therefore must identify such â€œturningâ€ points and subdivide the curved interval into sub-intervals with non-zero derivatives that can each be easily rectangle-bounded. The projected ray has a simple implicit form, allowing us to retrieve those points using closed-form computations. That form is derived by transforming Eq. (2)</a><span class="p"> to remove its dependency on the ray parameter </span>ğ‘¡ <span class="p">:</span></p><p class="s7" style="padding-top: 10pt;padding-left: 53pt;text-indent: 0pt;text-align: right;"><a name="bookmark19"><span class="s19">ğœ“ </span></a>(<span class="s19">ğ‘¢, ğ‘£</span>) <span class="s38">= </span><span class="p">det </span>(<span class="s37">P</span>(<span class="s19">ğ‘¢, ğ‘£</span>) âˆ’ <span class="s37">O</span><span class="s19">, </span><span class="s37">N</span>(<span class="s19">ğ‘¢, ğ‘£</span>)<span class="s19">, </span><span class="s37">D</span>) <span class="s38">= </span><span class="p">0</span><span class="s19">.    </span><span class="p">(3)</span></p><p style="padding-top: 1pt;padding-left: 20pt;text-indent: 0pt;line-height: 89%;text-align: justify;">where <span class="s37">P</span><span class="s48">ğ‘¢ </span>, <span class="s37">P</span><span class="s48">ğ‘£ </span>, <span class="s37">N</span><span class="s48">ğ‘¢ </span>, and <span class="s37">N</span><span class="s48">ğ‘£ </span>, are the partial derivatives of the interpo- lated base position and normalâ€”all constant inside a base triangle. Each <span class="s19">ğœ“</span><span class="s47">ğ‘¢ </span><span class="s38">= </span>0 and <span class="s19">ğœ“</span><span class="s47">ğ‘£ </span><span class="s38">= </span>0 defines a line in tex-</p><p style="text-indent: 0pt;text-align: left;"><span><img width="87" height="54" alt="image" src="rmip_files/Image_015.png"/></span></p><p style="padding-left: 20pt;text-indent: 0pt;line-height: 90%;text-align: justify;">ture space. We can retrieve the zero-derivative points by intersecting the projected ray with those two lines, which boils down to solving two quadratic equations. This yields at most</p><p style="padding-left: 20pt;text-indent: 0pt;line-height: 90%;text-align: justify;">four such points, meaning at most four subdivisions of the initial interval. In practice we never end up subdividing more than once.</p></li><li data-list-text="4.3"><h2 style="padding-top: 7pt;padding-left: 45pt;text-indent: -24pt;text-align: justify;"><a name="bookmark11">Ray-bound tightening</a></h2><p style="padding-top: 1pt;padding-left: 20pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a href="#bookmark16" class="a">The goal of the traversal is to tighten the ray bound until it is small enough to allow direct intersection tests with a local, texel-level reconstruction of the displaced surface. We have two ways to shrink that bound which we illustrate in Fig. 5</a> and detail next.</p><p class="s17" style="padding-top: 6pt;padding-left: 20pt;text-indent: 9pt;line-height: 90%;text-align: justify;"><a name="bookmark20">Ray-interval projection. </a><a href="#bookmark16" class="a">Every time we perform ray-box intersec- tion in 3D, we invert the displacement for the intersection-interval endpoints (Fig.</a><span class="p"> 5a). This can yield a new 2D ray bound that is tighter than the initial one, sometimes drastically. Rays that are near-parallel to the displacement directions have 2D projections smaller than the size of a texel. Traversal-time complexity is thus constant for such rays as they can be directly tested against the displaced surface within that texel.</span></p><p class="s17" style="padding-top: 6pt;padding-left: 20pt;text-indent: 9pt;line-height: 90%;text-align: justify;"><a name="bookmark21">Bound subdivision. </a><a href="#bookmark57" class="a">Bound tightening via interval projection is beneficial only for some rays. We need explicit subdivision to guar- antee that bounds eventually shrink to a size small enough for direct intersection. To that end, Patterson et al. [1991]</a><a href="#bookmark16" class="a"> project the 3D intersection-interval midpoint to texture space to form the two subdomains (Fig.</a><span class="p"> 5b). However, in our case the 3D bounds are com- puted using range arithmetic, providing no tightness guarantee.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 6pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a href="#bookmark16" class="a">Thus the midpoint texture-space projection can lie anywhere along the projected ray, which can lead to unbalanced splitting and ar- bitrarily long traversal. We instead split the domain directly in texture space: we use the implicit form to compute the intersection between the interval curve and the line splitting the longer side of the bound in the middle (Fig.</a> 5c). This scheme culls half the bound area and puts a strict upper bound on the number of traversal steps.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="4.4"><h2 style="padding-left: 78pt;text-indent: -24pt;text-align: justify;"><a name="bookmark12">Texel marching</a></h2><p style="padding-top: 1pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a href="#bookmark67" class="a">The final stage of our traversal routine is a direct intersection test with a local reconstruction of the displaced surface. This step is triggered when the 2D bounds become small enough, typically the size of a texel [Thonat et al. </a><a href="#bookmark67">2021].</a></p><p style="text-indent: 0pt;text-align: left;"><span><img width="126" height="98" alt="image" src="rmip_files/Image_016.png"/></span></p><p style="padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;">However, we found that it is more efficient to stop the traversal earlier, and march along the projected ray through the texels it crosses. The sign of the implicit form <a href="#bookmark19" style=" color: black; font-family:&quot;DejaVu Serif Condensed&quot;, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt;">ğœ“ </a><a href="#bookmark19" class="a">(3)</a> at each texel corner indicates from which edge the ray leaves the texel, as illustrated in the inline figure on the right.</p><p style="padding-left: 53pt;text-indent: 10pt;line-height: 90%;text-align: justify;"><a href="#bookmark28" class="a">We identify two reasons why switching to direct intersection earlier is more efficient. Firstly, our 2D bounds are arbitrary rectan- gles that are not aligned with the texels of the displacement map. That is, a texel is typically covered by multiple rectangles along the ray, which leads to multiple, redundant direct-intersection tests for that texel. Texel marching amortizes this redundancy. Secondly, the (finest) resolution of our RMIP structure may be smaller than that of the input displacement map. Once the 2D ray bounds become smaller than the RMIP resolution, the scalar displacement bounds returned by RMIP stop getting tighter. Texel marching allows to avoid querying the RMIP below this threshold size. In Section 6</a> we discuss the performance impact of the rectangle-size threshold at which we switch to texel marching.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li></ol></li><li data-list-text="5"><h2 style="padding-left: 70pt;text-indent: -16pt;line-height: 0pt;text-align: justify;"><a name="bookmark22">RMIP STRUCTURE</a><a name="bookmark23">&zwnj;</a></h2><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 20pt;text-indent: 0pt;text-align: left;"><span><img width="176" height="27" alt="image" src="rmip_files/Image_017.png"/></span>	<span><img width="116" height="33" alt="image" src="rmip_files/Image_018.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 20pt;text-indent: 0pt;text-align: left;"><span><img width="325" height="127" alt="image" src="rmip_files/Image_019.png"/></span></p><p class="s7" style="text-indent: 0pt;line-height: 11pt;text-align: left;">(  )</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-top: 1pt;padding-left: 20pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a name="bookmark24"><b>Figure 6: Layout of our RMIP structure as a 2D texture with multiple layers (columns) and mip levels (rows). Each pixel of every sub-texture represents the top-left corner of a query and stores the minmax displacement value over a region of size </b></a>2<span class="s50">ğ‘</span><span class="s49">, </span>2<span class="s50">ğ‘ </span><a href="#bookmark25" class="s8">. We show example queries in color, with top- left corners marked by circles. Green queries are contained fully inside the unit texture square; orange queries cross the square, enabling the use of Alg. 2</a><b> with wrapping queries. Semi-transparent layers are copies of other layers within the same mip level, enabling hardware sampling at fractional level of detail (LoD), i.e. interpolation across levels (rows).</b></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s7" style="text-indent: 0pt;line-height: 11pt;text-align: left;">â‰¤   âˆ’    â‰¤   âˆ’</p><p style="text-indent: 0pt;text-align: left;"/><p class="s7" style="text-indent: 0pt;line-height: 11pt;text-align: left;">â‰¤  â‰¤                  (  )</p><p style="text-indent: 0pt;text-align: left;"/><p class="s7" style="text-indent: 0pt;line-height: 11pt;text-align: left;">(  )</p><p style="text-indent: 0pt;text-align: left;"/><p class="s43" style="text-indent: 0pt;line-height: 7pt;text-align: left;">ğ‘¥,ğ‘¦</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 20pt;text-indent: 10pt;line-height: 87%;text-align: justify;"><a href="#bookmark45" class="a">We instead follow the approach of Amir et al. [2007],</a> who noted that any 2D range query can be decomposed into four, possibly overlapping sub-queries whose side lengths are powers of two. It is therefore sufficient to pre-compute the minmax values for all such sub-queries. Such a query is specified by its side length 2<span class="s50">ğ‘</span><span class="s49">, </span>2<span class="s50">ğ‘ </span>, with 0  <span class="s19">ğ‘, ğ‘  </span>log<span class="s51">2</span> <span class="s19">ğ‘ </span>, and the position of its top left corner <span class="s19">ğ‘¥, ğ‘¦ </span>, with 0  <span class="s19">ğ‘¥ </span><span class="s52">&lt; </span><span class="s19">ğ‘  </span>2<span class="s50">ğ‘ </span>, and 0  <span class="s19">ğ‘¦ </span><span class="s52">&lt; </span><span class="s19">ğ‘  </span>2<span class="s50">ğ‘ </span>. We assume the input displacement map is square with power-of-two side <span class="s19">ğ‘ </span>. We denote by <span class="s19">ğ» </span><span class="s53">ğ‘,ğ‘ </span>the precomputed minmax query with size <span class="s7">(</span>2<span class="s50">ğ‘</span><span class="s49">, </span>2<span class="s50">ğ‘ </span><span class="s7">) </span>and position <span class="s7">(</span><span class="s19">ğ‘¥, ğ‘¦</span><span class="s7">)</span>. The query for a rectangle with arbitrary size <span class="s7">(</span><span class="s19">ğ‘¤, â„</span><span class="s7">)</span></p><p style="padding-left: 20pt;text-indent: 0pt;line-height: 5pt;text-align: justify;">and top-left position <span class="s7">(</span><span class="s19">ğ‘¥, ğ‘¦</span><span class="s7">) </span>is the minmax of four <span class="s19">ğ» </span>values:</p><p class="s19" style="padding-top: 11pt;padding-left: 53pt;text-indent: 0pt;line-height: 4pt;text-align: right;">ğ‘…ğ‘€ğ‘„ <span class="s7">(</span>ğ‘¥, ğ‘¦, ğ‘¤, â„<span class="s7">) </span><span class="s38">= </span><span class="p">minmax</span><span class="s54"> </span>ğ» <span class="s53">ğ‘,ğ‘</span>, ğ» <span class="s53">ğ‘,ğ‘</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s55" style="padding-left: 4pt;text-indent: 0pt;line-height: 4pt;text-align: left;">, ğ» <span class="s56">ğ‘,ğ‘</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s55" style="padding-left: 10pt;text-indent: 0pt;line-height: 4pt;text-align: left;">, ğ» <span class="s56">ğ‘,ğ‘</span></p><p class="s54" style="padding-top: 13pt;padding-left: 4pt;text-indent: 0pt;line-height: 2pt;text-align: left;"> <span class="s19">, </span><span class="p">(5)</span></p><p style="padding-top: 1pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;">The axis-aligned bounds of ray intervals in texture space can have arbitrary rectangular shape, assuming the rays are uniformly dis- tributed in 3D. Recall that our traversal requires bounds for the scalar displacement inside these rectangles. A minmax mipmap, the</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 20pt;text-indent: 0pt;text-align: left;">where</p><p class="s7" style="padding-top: 1pt;padding-left: 36pt;text-indent: 0pt;line-height: 12pt;text-align: left;">(<span class="s19">ğ‘, ğ‘</span>) <span class="s38">= </span>âŒŠ<span class="p">log</span><span class="s51">2</span>(<span class="s19">ğ‘¤, â„</span>)âŒ‹<span class="s19">,</span></p><p class="s43" style="padding-top: 3pt;padding-left: 53pt;text-indent: 0pt;text-align: right;">ğ‘¥,ğ‘¦</p><p class="s43" style="padding-top: 3pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">ğ‘š<span class="s57">ğ‘¥ </span>,ğ‘¦</p><p class="s43" style="padding-top: 3pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">ğ‘š<span class="s57">ğ‘¥ </span>,ğ‘š<span class="s57">ğ‘¦</span></p><p class="s43" style="padding-top: 3pt;padding-left: 8pt;text-indent: 0pt;text-align: left;">ğ‘¥,ğ‘š<span class="s57">ğ‘¦</span></p><p style="padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;">standard data structure used to retrieve such bounds, would provide excessively loose bounds for highly anisotropic queries. To that end, in this section we introduce a novel minmax data structure that we call <span class="s17">rectangular minmax image pyramid (RMIP)</span>, which provides bounds for arbitrarily shaped rectangles.</p><p style="padding-left: 53pt;text-indent: 9pt;line-height: 90%;text-align: justify;"><a href="#bookmark34" class="a">The 2D range minimum query (RMQ) problem asks for the min- imum value over axis-aligned rectangular regions within a discrete 2D grid. This problem has been well studied in the literature, and solutions typically rely on pre-possessing the input grid into a data structure, with different trade-offs in complexity between pre- processing time, query time, and storage [Fischer and Heun </a><a href="#bookmark50" class="a">2011; Brodal et al. </a><a href="#bookmark73" class="a">2012]. Solutions to the 2D RMQ problem with constant- time query and asymptotic linear pre-processing time and storage are known [Yuan and Atallah 2010],</a> but the amount of intermedi- ate data structures and indirections required for a query make the practicality of an implementation unclear for real time rendering.</p><p class="s7" style="padding-top: 1pt;padding-left: 22pt;text-indent: 0pt;text-align: justify;">(<span class="s19">ğ‘š</span><span class="s47">ğ‘¥ </span><span class="s19">, ğ‘š</span><span class="s47">ğ‘¦ </span>) <span class="s38">= </span>(<span class="s19">ğ‘¥, ğ‘¦</span>) + (<span class="s19">ğ‘¤, â„</span>) âˆ’ (<span class="p">2</span><span class="s50">ğ‘</span><span class="s49">, </span><span class="p">2</span><span class="s50">ğ‘ </span>)<span class="s19">.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="128" height="88" alt="image" src="rmip_files/Image_020.png"/></span></p><p class="s7" style="text-indent: 0pt;line-height: 11pt;text-align: left;">( +  )</p><p style="text-indent: 0pt;text-align: left;"/><p class="s7" style="text-indent: 0pt;line-height: 11pt;text-align: left;">( +  )</p><p style="text-indent: 0pt;text-align: left;"/><p class="s19" style="padding-top: 5pt;padding-left: 20pt;text-indent: 0pt;line-height: 80%;text-align: justify;"><span class="p">We have 1 log</span><span class="s58">2 </span>ğ‘ <span class="s59">2 </span><span class="s60">possible query sizes, and for each we have </span>ğ‘ <span class="s61">2</span><span class="p"> possible positions, so there are </span>ğ‘ <span class="s59">2 </span><span class="s60">1 log</span><span class="s62">2 </span>ğ‘ <span class="s59">2</span></p><p style="padding-left: 20pt;text-indent: 0pt;line-height: 9pt;text-align: justify;">total minmax <span class="s19">ğ» </span>values. We assemble the values for each query size</p><p class="s7" style="text-indent: 0pt;line-height: 11pt;text-align: left;">(  )</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 20pt;text-indent: 3pt;line-height: 90%;text-align: justify;">2<span class="s50">ğ‘</span><span class="s49">, </span>2<span class="s50">ğ‘ </span><a href="#bookmark24" class="a">into a 2D grid, at power-of-two scales. We pack all grids into one multi-layer, multi-level texture that maps efficiently onto triangle meshes. This texture, depicted in Fig. 6,</a><a href="#bookmark25" class="a"> is what we call our RMIP structure; Alg. 2</a> shows pseudo-code for querying it.</p><p class="s7" style="text-indent: 0pt;line-height: 11pt;text-align: left;">( +  )</p><p style="text-indent: 0pt;text-align: left;"/><p class="s19" style="padding-left: 20pt;text-indent: 9pt;line-height: 86%;text-align: justify;"><span class="p">In the supplemental document we describe how we construct the RMIP from a given displacement map, and how we practically reduce its memory footprint from </span>ğ‘ <span class="s59">2 </span><span class="s60">1  log</span><span class="s62">2 </span>ğ‘ <span class="s59">2 </span><span class="s60">to </span>ğ‘ <span class="s59">2</span><span class="s60">, i.e. to the order of a classical mipmap. We also discuss details about bounding continuously interpolated (displacement) signals, tiled over the </span>ğ‘¢ğ‘£ <span class="p">plane, and fractional-LoD support.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><h3 style="padding-top: 5pt;padding-bottom: 3pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a name="bookmark25">Algorithm 2: Range minmax query (RMQ) using our RMIP structure, for a given </a><span class="s19">ğ‘¢ğ‘£ </span>rectangle and a (possibly fractional) level of detail (LoD) <span class="s19">ğœ†</span>.</h3><p style="padding-left: 53pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="317" height="1" alt="image" src="rmip_files/Image_021.png"/></span></p><p class="s14" style="padding-left: 58pt;text-indent: 0pt;line-height: 10pt;text-align: justify;"><span class="s20">1</span><span class="s21">: </span><b>function </b>RMIP_RMQ(<span class="s22">ğ‘¢ğ‘£</span><span class="s63">min</span>, <span class="s22">ğ‘¢ğ‘£</span><span class="s63">max</span>, <span class="s22">ğœ†</span>, <span class="s22">ğ‘Ÿğ‘šğ‘–ğ‘</span>)</p><p class="s22" style="padding-top: 1pt;padding-left: 54pt;text-indent: 3pt;line-height: 81%;text-align: justify;"><span class="s20">2</span><span class="s21">:  </span>ğ‘Ÿ <span class="s24">= </span><span class="s14">textureSize</span><span class="s23">(</span>ğ‘Ÿğ‘šğ‘–ğ‘, <span class="s14">0</span><span class="s23">)       </span><span class="s25">â† </span><span class="s28">RMIP resolution at LoD 0 </span><span class="s20">3</span><span class="s21">:  </span>ğ‘<span class="s64">min </span><span class="s24">= </span><span class="s23">âŒŠ</span>ğ‘¢ğ‘£<span class="s64">min </span><span class="s23">Â· </span>ğ‘Ÿ <span class="s23">âŒ‹</span>, ğ‘<span class="s64">max </span><span class="s24">= </span><span class="s23">âŒˆ</span>ğ‘¢ğ‘£<span class="s64">max </span><span class="s23">Â· </span>ğ‘Ÿ <span class="s23">âŒ‰   </span><span class="s25">â† </span><span class="s28">Query pixel corners </span><span class="s20">4</span><span class="s21">:  </span>ğ‘  <span class="s24">= </span><span class="s23">âŒŠ</span><span class="s14">log</span><span class="s65">2 </span><span class="s23">(</span>ğ‘<span class="s64">max </span><span class="s23">âˆ’ </span>ğ‘<span class="s64">min </span><span class="s23">) âŒ‹       </span><span class="s25">â† </span><span class="s28">Query log size in pixels </span><span class="s20">5</span><span class="s21">:  </span>ğ‘– <span class="s24">= </span>ğ‘ .ğ‘¥ <span class="s23">+ </span>ğ‘ .ğ‘¦ <span class="s23">Â· </span><span class="s14">rmip array stride   </span><span class="s27">â† </span><span class="s28">RMIP texture array layer index </span><span class="s20">6</span><span class="s21">:  </span>ğ‘¢ğ‘£<span class="s64">min </span><span class="s24">= </span><span class="s23">(</span>ğ‘<span class="s64">min </span><span class="s23">+ </span><span class="s14">0</span>.<span class="s14">5</span><span class="s23">) / </span>ğ‘Ÿ        <span class="s27">â† </span><span class="s28">Adjust to pixel center </span><span class="s20">7</span><span class="s21">:  </span>ğ‘¢ğ‘£<span class="s64">mid </span><span class="s24">= </span><span class="s23">(</span>ğ‘<span class="s64">max </span><span class="s23">+ </span><span class="s14">0</span>.<span class="s14">5 </span><span class="s23">âˆ’ </span><span class="s14">2</span><span class="s66">ğ‘  </span><span class="s23">) / </span>ğ‘Ÿ   <span class="s27">â† </span><span class="s28">Bottom-left sub-queryâ€™s top right </span><span class="s20">8</span><span class="s21">:  </span>ğ‘<span class="s63">1</span><span class="s14"> </span><span class="s24">= </span><span class="s14">textureLoD</span><span class="s23">(</span>ğ‘Ÿğ‘šğ‘–ğ‘, ğ‘¢<span class="s63">min</span>, ğ‘£<span class="s63">min</span>, ğ‘–, ğœ†<span class="s23">)    </span><span class="s25">â† </span><span class="s28">Top-left sub-query </span><span class="s20">9</span><span class="s21">:  </span>ğ‘<span class="s63">2</span><span class="s14"> </span><span class="s24">= </span><span class="s14">textureLoD</span><span class="s23">(</span>ğ‘Ÿğ‘šğ‘–ğ‘, ğ‘¢<span class="s63">mid</span>, ğ‘£<span class="s63">min</span>, ğ‘–, ğœ†<span class="s23">)   </span><span class="s25">â† </span><span class="s28">Top-right sub-query </span><span class="s20">10</span><span class="s21">:  </span>ğ‘<span class="s63">3</span><span class="s14"> </span><span class="s24">= </span><span class="s14">textureLoD</span><span class="s23">(</span>ğ‘Ÿğ‘šğ‘–ğ‘, ğ‘¢<span class="s63">min</span>, ğ‘£<span class="s63">mid</span>, ğ‘–, ğœ†<span class="s23">)   </span><span class="s25">â† </span><span class="s28">Bottom-left sub-query </span><span class="s20">11</span><span class="s21">:  </span>ğ‘<span class="s63">4</span><span class="s14"> </span><span class="s24">= </span><span class="s14">textureLoD</span><span class="s23">(</span>ğ‘Ÿğ‘šğ‘–ğ‘, ğ‘¢<span class="s63">mid</span>, ğ‘£<span class="s63">mid</span>, ğ‘–, ğœ†<span class="s23">)  </span><span class="s25">â† </span><span class="s28">Bottom-right sub-query</span></p><p class="s32" style="padding-left: 53pt;text-indent: 0pt;line-height: 10pt;text-align: justify;"><span class="s29"> </span><span class="s30">12</span><span class="s31">: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="s67">return  </span><span class="s33">minmax</span><span class="s34">(</span>ğ‘<span class="s68">1</span>,<span class="s22"> </span>ğ‘<span class="s68">2</span>,<span class="s22"> </span>ğ‘<span class="s68">3</span>,<span class="s22"> </span>ğ‘<span class="s68">4</span><span class="s33"> </span><span class="s34">) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 53pt;text-indent: 9pt;line-height: 90%;text-align: justify;"><a href="#bookmark69" class="a">For micro-structure rendering, Wang et al. [2020]</a><a href="#bookmark45" class="a"> proposed a similar data structure, also based on that of Amir et al. [2007].</a> Our RMIP structure encodes a richer set of queries, supporting tiled signals and fractional LoDs, and has a GPU-friendly implementation. Moreover, our compression scheme is better suited to ray-tracing applications where bound tightness is crucial at early traversal steps. Our scheme reduces tightness mostly on queries smaller than the RMIP resolution, which only occur late in the traversal. In contrast, squared precomputed queries yield looser bounds at all scales.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="6"><h2 style="padding-left: 70pt;text-indent: -16pt;text-align: left;"><a name="bookmark26">RESULTS</a><a name="bookmark27">&zwnj;</a></h2><p style="padding-top: 1pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: right;"><a href="#bookmark68" class="a">We implemented our method on CPU and GPU, using Embree [Wald et al. 2014]</a><a href="#bookmark48" class="a"> and Vulkan Ray Tracing [Khronos 2020].</a><a href="#bookmark74" class="a"> Our two-level approach (find base triangle, then intersect it) is supported by those ray-tracing frameworks through custom geometry. It requires a bounding box for each custom primitiveâ€”per bounding prism in our case, and a custom intersection programâ€”our hybrid traversal. We present results of our method integrated in the Adobe Mer- cury Rendering Engine. We show examples with high-resolution displacement maps, a range of tiling factors, and variety of base surfaces, seen in Fig. 8.</a> All results were produced on a desktop ma- chine with a 16-core AMD Ryzen 9 5950X CPU and an NVIDIA RTX 3080 GPU with 10 GB of memory. We evaluate our method along</p><p style="padding-left: 53pt;text-indent: 0pt;line-height: 12pt;text-align: justify;">three axes: performance, visual quality, and memory footprint.</p><p class="s7" style="text-indent: 0pt;line-height: 11pt;text-align: left;">Ã—</p><p style="text-indent: 0pt;text-align: left;"/><p class="s7" style="text-indent: 0pt;line-height: 11pt;text-align: left;">Ã—</p><p style="text-indent: 0pt;text-align: left;"/><p class="s17" style="padding-top: 9pt;padding-left: 53pt;text-indent: 10pt;line-height: 90%;text-align: left;">Tessellation-free displacement. <a href="#bookmark67" class="a">Our main competitor is the TFDM method [Thonat et al. 2021].</a><a href="#bookmark29" class="a"> As we share a common tessellation-free framework, ours has identical inputs and outputs, and yields the same visual quality. We therefore compare performance and mem- ory consumption. As seen in Table 1,</a><a href="#bookmark76" class="a"> ours significantly outperforms TFDM in an equal-memory setup, with an average speed-up of 5 (with a 3  standard deviation) over all scenes. We also show that we can reach their level of performance with only a fraction of the memory cost. In Fig. 10,</a><a href="#bookmark75" class="a"> we show that our method performs increas- ingly better when pushing the displacement scaling or displacement tiling, confirming its better asymptotic traversal complexity. Finally, Fig. 9</a><a href="#bookmark7" class="a"> shows that our ray-adaptive hierarchies reduce the number of considered 2D bounds during traversal (i.e., the size of the while loop in Alg. 1)</a><span class="p"> by an order of magnitude over TFDM.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 20pt;text-indent: 0pt;text-align: left;"><span><img width="320" height="140" alt="image" src="rmip_files/Image_022.png"/></span></p><h3 style="padding-top: 4pt;padding-left: 20pt;text-indent: 0pt;line-height: 90%;text-align: left;">Figure 7: Caustics rendered using photon mapping, without displacement mapping (left) and using our method (right).</h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 20pt;text-indent: 9pt;line-height: 90%;text-align: justify;">Editability. <span class="p">As our data structures are efficient to compute on the GPU, displacement editing is as easy as in TFDM. Displacement modifications trigger an RMIP rebuild. With our compression, this is equivalent to building a minmax mipmap, and takes approximately 5ms for a 4k displacement map using a naive implementation. On the other hand, modifying the displacement parameters triggers pre-computations only for the base triangles, most notably the bounding prisms, which takes less than 1ms on all our examples.</span></p><p class="s17" style="padding-top: 6pt;padding-left: 20pt;text-indent: 10pt;line-height: 90%;text-align: justify;"><a name="bookmark28">Ablation study. </a><a href="#bookmark35" class="a">We study several components of our method. First, we swap out RMIP for a standard minmax mipmap in our traversal. Such a mipmap can be used to compute bounds on an arbitrary axis-aligned rectangle by finding the smallest four neigh- boring texels whose union contains the rectangle [Greene et al. </a><a href="#bookmark62" class="a">1993], as used for GPU occlusion culling [Shopf et al. </a><a href="#bookmark78" class="a">2008]. In Fig. 11</a><span class="p"> we show that in our ray-tracing context, at equivalent mem- ory consumption, the bounds obtained from the mipmap degrades performance compared to RMIP. This is because the queries are made over arbitrary rectangles bounding ray projections, and the mipmap performs poorly for such generally anisotropic queries.</span></p><p style="padding-left: 19pt;text-indent: 10pt;line-height: 90%;text-align: right;">Second, we rely on texel marching to both amortize query-texel misalignments and compensate for the limited RMIP resolution. We use a <span class="s17">marching scale </span><a href="#bookmark78" class="a">parameter to control the 2D-size threshold below which we switch from bound subdivision to texel march- ing. In Fig. 11</a><a href="#bookmark16" class="a"> we show that for every RMIP resolution there is a marching-scale sweet-spot that gives the best performance. Intu- itively, a large scale leads to a displacement-map traversal without much hierarchical acceleration, which is costly for high-resolution maps. Conversely, a small marching scale means the query-texel misalignment and limited RMIP resolution are no longer amortized. Finally, we study the efficiency of 2D-bound tightening through point-wise displacement inversion (Fig.</a><a href="#bookmark7" class="a"> 5a). While inversion is crit- ical for initializing the traversal, its usage during traversal (line 15 in Alg. 1)</a><a href="#bookmark16" class="a"> is optional since 2D-bound subdivision (Fig.</a><a href="#bookmark79" class="a"> 5c) is enough to guarantee consistent bound shrinkage. We show in Fig. 12,</a> that while inversion provides significant performance improvement on average on CPU, its benefit on GPU is much less pronounced. We hypothesize that this difference is due to the SIMD nature of the GPU execution model. Indeed, while numerical inversion is rela- tively fast, it remains a costly operation that provides a significant region reduction only in certain configurations, e.g., when the ray hits an on-the-fly 3D AABB from the top or bottom. So since our traversal is heavily ray-dependant, it is unlikely that multiple tra- versals within an execution warp encounter a beneficial inversion.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s7" style="text-indent: 0pt;line-height: 11pt;text-align: left;">Ã—</p><p style="text-indent: 0pt;text-align: left;"/><h3 style="padding-top: 5pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a href="#bookmark67" class="s8" name="bookmark29">Table 1: Performance and memory-footprint comparison between TFDM [Thonat et al. 2021]</a> (serving as a 1 baseline), uniform tessellation, and our method with three different resolutions for our RMIP structure. For each configurations, the right column compares the data structure memory consumption (lower is better), and the right column reports render-time speed-ups on GPU (higher is better). Visual comparisons are shown in the supplemental document.</h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 53pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="673" height="1" alt="image" src="rmip_files/Image_023.png"/></span></p><table style="border-collapse:collapse" cellspacing="0"><tr style="height:24pt"><td style="width:67pt"><p class="s69" style="padding-top: 1pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">Scene</p></td><td style="width:27pt"><p class="s69" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">#Tri</p></td><td style="width:32pt"><p class="s69" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Disp.</p></td><td style="width:112pt" colspan="2"><p class="s70" style="padding-left: 7pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><b>Tiling  TFDM </b>(1<span class="s71">Ã—</span>)</p><p style="padding-left: 45pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><a href="#bookmark67" class="s72">[Thonat et al. 2021]</a></p></td></tr><tr style="height:12pt"><td style="width:67pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:27pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:32pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:74pt"><p class="s70" style="padding-right: 6pt;text-indent: 0pt;line-height: 10pt;text-align: right;">Mem.</p></td><td style="width:38pt"><p class="s70" style="padding-left: 10pt;text-indent: 0pt;line-height: 10pt;text-align: left;">GPU</p></td></tr><tr style="height:22pt"><td style="width:67pt"><p class="s73" style="padding-left: 4pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Alien Sphere Basket</p></td><td style="width:27pt"><p class="s70" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">0.9k</p><p class="s70" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">4.8k</p></td><td style="width:32pt"><p class="s70" style="padding-left: 11pt;padding-right: 13pt;text-indent: 0pt;line-height: 11pt;text-align: center;">2k 2k</p></td><td style="width:74pt"><p class="s70" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">6 <span class="s71">Ã— </span>8  21Mb</p></td><td style="width:38pt"><p class="s70" style="padding-left: 8pt;padding-right: 6pt;text-indent: 1pt;line-height: 11pt;text-align: left;">56ms 117ms</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><h4 style="padding-left: 296pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Pre-tessellation <span class="s74">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><u>Our traversal &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </u></h4><p style="text-indent: 0pt;text-align: left;"><span><img width="674" height="147" alt="image" src="rmip_files/Image_024.png"/></span></p><p class="s76" style="text-indent: 0pt;line-height: 10pt;text-align: left;">Creature</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;line-height: 11pt;text-align: left;">53k</p><p style="text-indent: 0pt;text-align: left;"/><p class="s76" style="text-indent: 0pt;line-height: 11pt;text-align: left;">Diving Helmet  <span class="s77">2.5k</span></p><p class="s76" style="text-indent: 0pt;line-height: 11pt;text-align: left;">Medieval Helmet <span class="s77">2.3k</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;">4k  1 <span class="s78">Ã— </span>1</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;">4k  1 <span class="s78">Ã— </span>1</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;">5 <span class="s78">Ã— </span>5</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;line-height: 11pt;text-align: left;">21Mb</p><p style="text-indent: 0pt;text-align: left;"/><p class="s78" style="text-indent: 0pt;text-align: left;">Ã—<span class="s77">186  </span>Ã—<span class="s77">91</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;">Mem.<span class="s78">â†“ </span>GPU<span class="s78">â†‘</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>0<span class="s79">.</span>048</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;">Mem.<span class="s78">â†“ </span>GPU<span class="s78">â†‘</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>2<span class="s79">.</span>7</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;">Mem.<span class="s78">â†“ </span>GPU<span class="s78">â†‘</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>1<span class="s79">.</span>3 <span class="s78">Ã—</span>3<span class="s79">.</span>4</p><p style="text-indent: 0pt;text-align: left;"/><p class="s78" style="text-indent: 0pt;text-align: left;">Ã—<span class="s77">30</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;">Mem.<span class="s78">â†“ </span>GPU<span class="s78">â†‘</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>2<span class="s79">.</span>7</p><p style="text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><span class="s77">85Mb </span><span class="s80" style=" background-color: #EEE;"> </span><span class="s81" style=" background-color: #EEE;">115ms </span><span class="s77"> </span><span class="s78">Ã—</span><span class="s77">40</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s78" style="text-indent: 0pt;text-align: left;">Ã—<span class="s77">235</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s78" style="text-indent: 0pt;text-align: left;">Ã—<span class="s77">232</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s78" style="text-indent: 0pt;text-align: left;">Ã—<span class="s77">67</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>0<span class="s79">.</span>048  <span class="s78">Ã—</span>5<span class="s79">.</span>0  <span class="s78">Ã—</span>1<span class="s79">.</span>3  <span class="s78">Ã—</span>6<span class="s79">.</span>3  <span class="s78">Ã—</span>30</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>5<span class="s79">.</span>0</p><p style="text-indent: 0pt;text-align: left;"/><p class="s76" style="text-indent: 0pt;text-align: left;">Elven Armor Ninja Head Terracotta Roof Desert Tire Glass</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;line-height: 11pt;text-align: left;">0.8k</p><p class="s77" style="text-indent: 0pt;line-height: 11pt;text-align: left;">8.7k</p><p class="s77" style="padding-left: 1pt;text-indent: 0pt;line-height: 11pt;text-align: left;">128</p><p class="s77" style="text-indent: 2pt;line-height: 91%;text-align: left;">9k 2.2k</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 69pt;text-indent: 0pt;line-height: 12pt;text-align: left;"><span class="s77">85Mb </span><span class="s80" style=" background-color: #EEE;"> </span><span class="s81" style=" background-color: #EEE;">33ms </span><span class="s77"> </span><span class="s78">Ã—</span><span class="s77">30</span></p><p class="s77" style="text-indent: 0pt;line-height: 12pt;text-align: left;">2k  5 <span class="s78">Ã— </span>5</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;">4k  2 <span class="s78">Ã— </span>2</p><p style="text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><span class="s77">21Mb </span><span class="s80" style=" background-color: #EEE;"> </span><span class="s81" style=" background-color: #EEE;">42ms </span><span class="s77"> </span><span class="s78">Ã—</span><span class="s77">111</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;line-height: 6pt;text-align: right;">0<span class="s79">.</span>012</p><p class="s78" style="text-indent: 0pt;text-align: left;">Ã—<span class="s77">95  </span><span class="s82">Ã—</span></p><p style="text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><span class="s77">85Mb </span><span class="s80" style=" background-color: #EEE;"> </span><span class="s81" style=" background-color: #EEE;">53ms </span><span class="s77"> </span><span class="s78">Ã—</span><span class="s77">37</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s78" style="text-indent: 0pt;text-align: left;">Ã—<span class="s77">132</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s78" style="text-indent: 0pt;text-align: left;">Ã—<span class="s77">93</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>0<span class="s79">.</span>012</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>4<span class="s79">.</span>3</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>1<span class="s79">.</span>6  <span class="s78">Ã—</span>7<span class="s79">.</span>8 <span class="s78">Ã—</span>7<span class="s79">.</span>6  <span class="s78">Ã—</span>9<span class="s79">.</span>3</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>0<span class="s79">.</span>012</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>0<span class="s79">.</span>048</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>2<span class="s79">.</span>5</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>2<span class="s79">.</span>5</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>1<span class="s79">.</span>6</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>2<span class="s79">.</span>7</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>1<span class="s79">.</span>3</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>3<span class="s79">.</span>0</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>1<span class="s79">.</span>6</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>3<span class="s79">.</span>2</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>7<span class="s79">.</span>6  <span class="s78">Ã—</span>3<span class="s79">.</span>5</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>3<span class="s79">.</span>4</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>7<span class="s79">.</span>6</p><p style="text-indent: 0pt;text-align: left;"/><p class="s78" style="text-indent: 0pt;text-align: left;">Ã—<span class="s77">30</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>2<span class="s79">.</span>8</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>4<span class="s79">.</span>1</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;">4k <span class="s78">Ã— </span>3 25<span class="s83">2</span>, 6 <span class="s78">Ã— </span>1</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;">2k  2 <span class="s78">Ã— </span>2</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;">2k  5 <span class="s78">Ã— </span>5</p><p style="text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><span class="s77">21Mb </span><span class="s80" style=" background-color: #EEE;"> </span><span class="s81" style=" background-color: #EEE;">182ms </span><span class="s77"> </span><span class="s78">Ã—</span><span class="s77">103</span></p><p style="text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><span class="s77">21Mb </span><span class="s80" style=" background-color: #EEE;"> </span><span class="s81" style=" background-color: #EEE;">27ms </span><span class="s77"> </span><span class="s78">Ã—</span><span class="s77">97</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>340  <span class="s78">Ã—</span>0<span class="s79">.</span>048  <span class="s78">Ã—</span>6<span class="s79">.</span>1  <span class="s78">Ã—</span>1<span class="s79">.</span>3  <span class="s78">Ã—</span>9<span class="s79">.</span>2  <span class="s78">Ã—</span>30</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>7<span class="s79">.</span>7</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;">2k  1 <span class="s78">Ã— </span>1</p><p style="text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><span class="s77">256Mb </span><span class="s80" style=" background-color: #EEE;"> </span><span class="s81" style=" background-color: #EEE;">606ms </span><span class="s77"> </span><span class="s78">Ã—</span><span class="s77">10</span></p><p style="text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><span class="s77">42Mb </span><span class="s80" style=" background-color: #EEE;"> </span><span class="s81" style=" background-color: #EEE;">41ms </span><span class="s77"> </span><span class="s78">Ã—</span><span class="s77">51</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s78" style="text-indent: 0pt;text-align: left;">Ã—<span class="s77">1151</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s78" style="text-indent: 0pt;text-align: left;">Ã—<span class="s77">69</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s78" style="text-indent: 0pt;text-align: left;">Ã—<span class="s77">12</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>0<span class="s79">.</span>012</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>0<span class="s79">.</span>048</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>2<span class="s79">.</span>2</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>0<span class="s79">.</span>66</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>6<span class="s79">.</span>5</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>1<span class="s79">.</span>3  <span class="s78">Ã—</span>3<span class="s79">.</span>0  <span class="s78">Ã—</span>30</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>2<span class="s79">.</span>4</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>2<span class="s79">.</span>5</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>0<span class="s79">.</span>32</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>1<span class="s79">.</span>3</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>2<span class="s79">.</span>7</p><p style="text-indent: 0pt;text-align: left;"/><p class="s78" style="text-indent: 0pt;text-align: left;">Ã—<span class="s77">11</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>7<span class="s79">.</span>6</p><p style="text-indent: 0pt;text-align: left;"/><p class="s78" style="text-indent: 0pt;text-align: left;">Ã—<span class="s77">16</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>9<span class="s79">.</span>6</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="text-indent: 0pt;text-align: left;"><span class="s78">Ã—</span>2<span class="s79">.</span>7</p><p style="text-indent: 0pt;text-align: left;"/><p class="s77" style="padding-left: 311pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Uniform   <b>Low-res. RMIP   RMIP   High-res. RMIP</b></p><p style="padding-left: 221pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="443" height="1" alt="image" src="rmip_files/Image_025.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="7"><h2 style="padding-left: 70pt;text-indent: -16pt;text-align: left;"><a name="bookmark30">DISCUSSION</a></h2></li></ol><p class="s17" style="padding-top: 1pt;padding-left: 53pt;text-indent: 9pt;line-height: 90%;text-align: justify;"><a name="bookmark31">Limitations &amp; future work. </a><span class="p">When using displacement maps with moderate resolution or limited tiling, and keeping the displacement content static, then combining pre-tessellation, pre-displacement, and hardware ray tracing remains the method of choice, even if ac- curate displacement meshing can be very challenging depending on the actual UV layout of the base domain. A number of design choices in our approach are heavily biased by our application scenarioâ€” dynamic GPU displacement tracing. Nevertheless, we believe that RMIP could be instrumental in a number of other level-of-detail problems, including approximation models for physics simulation and high-resolution geo mapping.</span><a name="bookmark32">&zwnj;</a><a name="bookmark33">&zwnj;</a><a name="bookmark34">&zwnj;</a><a name="bookmark35">&zwnj;</a></p><p class="s17" style="padding-top: 8pt;padding-left: 53pt;text-indent: 9pt;line-height: 90%;text-align: justify;"><a name="bookmark36">Conclusion. </a><span class="p">By coupling displacement inversion with range arith- metic, our method establishes an efficient bidirectional communica- tion channel between texture space and 3D space, enabling efficient and ray-dependent texture-space pruning when seeking an inter- section. As a result, RMIP displacement ray tracing is on average five times faster than the state of the art at equal image quality.</span><a name="bookmark37">&zwnj;</a><a name="bookmark38">&zwnj;</a><a name="bookmark39">&zwnj;</a></p><h2 style="padding-top: 9pt;padding-left: 53pt;text-indent: 0pt;text-align: left;"><a name="bookmark40">ACKNOWLEDGMENTS</a></h2><p style="padding-top: 1pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a name="bookmark41">The authors thank Luc Chamerlat for helping create our beautiful test scenes, AndrÃ©a Machizaud for his reliable assistance with the renderer, Thomas Caissard for helping with photon mapping, and the anonymous reviewers for their their useful feedback.</a><a name="bookmark42">&zwnj;</a><a name="bookmark43">&zwnj;</a></p><h2 style="padding-top: 9pt;padding-left: 53pt;text-indent: 0pt;text-align: left;"><a name="bookmark44">REFERENCES</a><a name="bookmark45">&zwnj;</a></h2><p class="s9" style="padding-top: 1pt;padding-left: 63pt;text-indent: -9pt;line-height: 84%;text-align: justify;"><a name="bookmark46">Amihood Amir, Johannes Fischer, and Moshe Lewenstein. 2007. Two-dimensional range minimum queries. In </a><span class="s10">Combinatorial Pattern Matching: 18th Annual Symposium, CPM 2007, London, Canada, July 9-11, 2007. Proceedings 18</span>. Springer, 286â€“294.<a name="bookmark47">&zwnj;</a><a name="bookmark48">&zwnj;</a></p><p class="s9" style="padding-left: 63pt;text-indent: -9pt;line-height: 84%;text-align: justify;"><a name="bookmark49">Lionel Baboud, Elmar Eisemann, and Hans-Peter Seidel. 2011. Precomputed safety shapes for efficient and accurate height-field rendering. </a><span class="s10">IEEE transactions on visu- alization and computer graphics </span>18, 11 (2011), 1811â€“1823.<a name="bookmark50">&zwnj;</a></p><p class="s9" style="padding-left: 53pt;text-indent: 0pt;line-height: 84%;text-align: right;"><a name="bookmark51">Gerth StÃ¸lting Brodal, Pooya Davoodi, and S Srinivasa Rao. 2012. On space efficient two dimensional range minimum data structures. </a><span class="s10">Algorithmica </span>63 (2012), 815â€“830. Nathan A Carr, Jared Hoberock, Keenan Crane, and John C Hart. 2006. Fast GPU ray tracing of dynamic meshes using geometry images.. In <span class="s10">Graphics Interface</span>, Vol. 2006.<a name="bookmark52">&zwnj;</a><a name="bookmark53">&zwnj;</a></p><p class="s9" style="padding-left: 63pt;text-indent: 0pt;line-height: 8pt;text-align: left;"><a name="bookmark54">Citeseer, 203â€“209.</a></p><p class="s9" style="padding-left: 63pt;text-indent: -9pt;line-height: 84%;text-align: justify;">Per H. Christensen, David M. Laur, Julia Fong, Wayne L. Wooten, and Dana Batali. 2003.  Ray Differentials and Multiresolution Geometry Caching</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 29pt;text-indent: 0pt;line-height: 84%;text-align: left;">for Distribution Ray Tracing in Complex Scenes. <span class="s10">Computer Graphics Fo- rum </span><a href="https://doi.org/10.1111/1467-8659.t01-1-00702" class="s12" target="_blank">22, 3 (2003), 543â€“552.  https://doi.org/10.1111/1467-8659.t01-1-00702</a></p><p class="s9" style="padding-left: 20pt;text-indent: 9pt;line-height: 84%;text-align: left;">arXiv:https://onlinelibrary.wiley.com/doi/pdf/10.1111/1467-8659.t01-1-00702 Peter Djeu, Warren Hunt, Rui Wang, Ikrima Elhassan, Gordon Stoll, and William R.</p><p class="s9" style="padding-left: 29pt;text-indent: 0pt;line-height: 8pt;text-align: left;">Mark. 2011. Razor: An Architecture for Dynamic Multiresolution Ray Tracing.</p><p class="s10" style="padding-left: 29pt;text-indent: 0pt;line-height: 8pt;text-align: left;">ACM Trans. Graph. <a href="https://doi.org/10.1145/2019627.2019634" class="s12" target="_blank">30, 5, Article 115 (Oct. 2011), 26 pages. https://doi.org/10.1145/</a></p><p style="padding-left: 29pt;text-indent: 0pt;line-height: 8pt;text-align: left;"><a href="https://doi.org/10.1145/2019627.2019634" class="s12">2019627.2019634</a></p><p class="s9" style="padding-left: 20pt;text-indent: 0pt;line-height: 8pt;text-align: left;">William Donnelly. 2005. Per-pixel displacement mapping with distance functions.</p><p class="s10" style="padding-left: 29pt;text-indent: 0pt;line-height: 8pt;text-align: left;">GPU gems <span class="s9">2, 22 (2005), 3.</span></p><p class="s9" style="padding-left: 53pt;text-indent: 0pt;line-height: 84%;text-align: right;">Jonathan Dummer. 2006. Cone step mapping: An iterative ray-heightfield intersection algorithm. <a href="http://www/" class="s84" target="_blank">URL: </a><span class="s10">http://www. lonesock. net/files/ConeStepMapping. pdf </span>2, 3 (2006), 4.</p><p class="s9" style="padding-left: 29pt;text-indent: -9pt;line-height: 84%;text-align: justify;">Johannes Fischer and Volker Heun. 2011. Space-efficient preprocessing schemes for range minimum queries on static arrays. <span class="s10">SIAM J. Comput. </span>40, 2 (2011), 465â€“492.</p><p class="s9" style="padding-left: 29pt;text-indent: -9pt;line-height: 84%;text-align: justify;">Ned Greene, Michael Kass, and Gavin Miller. 1993. Hierarchical Z-buffer visibility. In <span class="s10">Proceedings of the 20th annual conference on Computer graphics and interactive techniques</span>. 231â€“238.</p><p class="s9" style="padding-left: 29pt;text-indent: -9pt;line-height: 84%;text-align: justify;">Johannes Hanika, Alexander Keller, and Hendrik P. A. Lensch. 2010. Two-Level Ray Tracing with Reordering for Highly Complex Scenes. In <span class="s10">Proceedings of Graphics Interface 2010 </span>(Ottawa, Ontario, Canada) <span class="s10">(GI â€™10)</span>. Canadian Information Processing Society, CAN, 145â€“152.</p><p class="s9" style="padding-left: 29pt;text-indent: -9pt;line-height: 84%;text-align: justify;">Takahiro Harada. 2015. Rendering Vector Displacement Mapped Surfaces in a GPU Ray Tracer. <span class="s10">GPU Pro 6: Advanced Rendering Techniques </span>(2015), 459.</p><p class="s9" style="padding-left: 29pt;text-indent: -9pt;line-height: 84%;text-align: justify;">John C Hart. 1996. Sphere tracing: A geometric method for the antialiased ray tracing of implicit surfaces. <span class="s10">The Visual Computer </span>12, 10 (1996), 527â€“545.</p><p class="s9" style="padding-left: 20pt;text-indent: 0pt;line-height: 8pt;text-align: justify;">W. Heidrich and H. Seidel. 1998. Ray-tracing Procedural Displacement Shaders. In</p><p class="s10" style="padding-left: 29pt;text-indent: 0pt;line-height: 8pt;text-align: left;">Graphics Interface<span class="s9">.</span></p><p class="s9" style="padding-left: 29pt;text-indent: -9pt;line-height: 84%;text-align: justify;">Warren Hunt, William R. Mark, and Don Fussell. 2007. Fast and Lazy Build of Accel- eration Structures from Scene Hierarchies. In <span class="s10">2007 IEEE Symposium on Interactive Ray Tracing</span><a href="https://doi.org/10.1109/RT.2007.4342590" class="s12" target="_blank">. 47â€“54. https://doi.org/10.1109/RT.2007.4342590</a></p><p class="s9" style="padding-left: 29pt;text-indent: -9pt;line-height: 84%;text-align: justify;">Stefan Jeschke, Stephan Mantler, and Michael Wimmer. 2007. Interactive Smooth and Curved Shell Mapping. In <span class="s10">Proceedings of the 18th Eurographics Conference on Rendering Techniques </span>(Grenoble, France) <span class="s10">(EGSRâ€™07)</span>. Eurographics Association, Goslar, DEU, 351â€“360.</p><p class="s9" style="padding-left: 29pt;text-indent: -9pt;line-height: 84%;text-align: justify;">Tomomichi Kaneko, Toshiyuki Takahei, Masahiko Inami, Naoki Kawakami, Yasuyuki Yanagida, Taro Maeda, and Susumu Tachi. 2001. Detailed shape representation with parallax mapping. In <span class="s10">Proceedings of ICAT</span>, Vol. 2001. 205â€“208.</p><p class="s9" style="padding-left: 29pt;text-indent: -9pt;line-height: 84%;text-align: justify;">Khronos. 2020. <span class="s10">Vulkan Ray Tracing specification</span><a href="https://www.khronos.org/blog/vulkan-ray-tracing-final-specification-release" class="s12" target="_blank">. https://www.khronos.org/blog/ vulkan-ray-tracing-final-specification-release</a></p><p class="s9" style="padding-left: 29pt;text-indent: -8pt;line-height: 84%;text-align: justify;">Alexandr Kuznetsov, Krishna Mullia, Zexiang Xu, MiloÅ¡ HaÅ¡an, and Ravi Ramamoorthi. 2021. NeuMIP: multi-resolution neural materials. <span class="s10">ACM Transactions on Graphics (TOG) </span>40, 4 (2021), 1â€“13.</p><p class="s9" style="padding-left: 29pt;text-indent: -9pt;line-height: 84%;text-align: justify;">Alexandr Kuznetsov, Xuezheng Wang, Krishna Mullia, Fujun Luan, Zexiang Xu, Milos Hasan, and Ravi Ramamoorthi. 2022. Rendering Neural Materials on Curved Surfaces. In <span class="s10">ACM SIGGRAPH 2022 Conference Proceedings</span>. 1â€“9.</p><p class="s9" style="padding-left: 29pt;text-indent: -9pt;line-height: 84%;text-align: justify;">L. Lee, Shih-Wei Tseng, and W. Tai. 2009. Improved Relief Texture Mapping Using Minmax Texture. <span class="s10">2009 Fifth International Conference on Image and Graphics </span>(2009), 547â€“552.</p><p class="s9" style="padding-left: 29pt;text-indent: -9pt;line-height: 84%;text-align: justify;">James R Logie and John W. Patterson. 1995. Inverse displacement mapping in the general case. In <span class="s10">Computer Graphics Forum</span>, Vol. 14. Wiley Online Library, 261â€“273.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-top: 6pt;padding-left: 63pt;text-indent: -9pt;line-height: 84%;text-align: justify;"><a name="bookmark55">Andrea Maggiordomo, Henry Moreton, and Marco Tarini. 2023. Micro-Mesh Con- struction. </a><span class="s10">ACM Transactions on Graphics (TOG) </span>42, 4 (2023), 1â€“18.<a name="bookmark56">&zwnj;</a></p><p class="s9" style="padding-left: 63pt;text-indent: -9pt;line-height: 84%;text-align: justify;"><a name="bookmark57">Kyoungsu Oh, Hyunwoo Ki, and Cheol-Hi Lee. 2006. Pyramidal displacement mapping: a gpu based artifacts-free ray tracing through an image pyramid. In </a><span class="s10">Proceedings of the ACM symposium on Virtual reality software and technology</span>. 75â€“82.</p><p class="s9" style="padding-left: 63pt;text-indent: -9pt;line-height: 84%;text-align: justify;"><a name="bookmark58">John W Patterson, Stuart G Hoggar, and James R Logie. 1991. Inverse displacement mapping. In </a><span class="s10">Computer Graphics Forum</span>, Vol. 10. Wiley Online Library, 129â€“139.</p><p class="s9" style="padding-left: 53pt;text-indent: 0pt;line-height: 8pt;text-align: justify;">Fabio Policarpo and Manuel M Oliveira. 2007. Relaxed cone stepping for relief mapping.</p><p class="s10" style="padding-left: 63pt;text-indent: 0pt;line-height: 8pt;text-align: justify;"><a name="bookmark59">GPU gems </a><span class="s9">3 (2007), 409â€“428.</span></p><p class="s9" style="padding-left: 63pt;text-indent: -9pt;line-height: 84%;text-align: justify;"><a name="bookmark60">FÃ¡bio Policarpo, Manuel M Oliveira, and JoÃ£o LD Comba. 2005. Real-time relief mapping on arbitrary polygonal surfaces. In </a><span class="s10">Proceedings of the 2005 symposium on Interactive 3D graphics and games</span>. 155â€“162.</p><p class="s9" style="text-indent: 0pt;line-height: 8pt;text-align: right;">Serban D. Porumbescu, Brian Budge, Louis Feng, and Kenneth I. Joy. 2005. Shell Maps.</p><p class="s10" style="padding-left: 53pt;text-indent: 0pt;line-height: 8pt;text-align: right;">ACM Trans. Graph. <a href="https://doi.org/10.1145/1073204.1073239" class="s12" target="_blank">24, 3 (July 2005), 626â€“633. https://doi.org/10.1145/1073204.</a></p><p style="padding-left: 62pt;text-indent: 0pt;line-height: 8pt;text-align: left;"><a href="https://doi.org/10.1145/1073204.1073239" class="s12" name="bookmark61">1073239</a></p><p class="s9" style="padding-left: 62pt;text-indent: -9pt;line-height: 84%;text-align: justify;"><a name="bookmark62">V. V. Sanzharov, V. A. Frolov, and V. A. Galaktionov. 2020. Survey of Nvidia RTX Technology. </a><span class="s10">Program. Comput. Softw. </span><a href="https://doi.org/10.1134/S0361768820030068" class="s12" target="_blank">46, 4 (jul 2020), 297â€“304. https://doi.org/10. 1134/S0361768820030068</a></p><p class="s9" style="padding-left: 63pt;text-indent: -9pt;line-height: 84%;text-align: justify;"><a name="bookmark63">Jeremy Shopf, Joshua Barczak, Christopher Oat, and Natalya Tatarchuk. 2008. March of the Froblins: simulation and rendering massive crowds of intelligent and detailed creatures on GPU. In </a><span class="s10">ACM SIGGRAPH 2008 Games</span>. 52â€“101.</p><p class="s9" style="padding-left: 63pt;text-indent: -9pt;line-height: 84%;text-align: justify;"><a name="bookmark64">Brian Smits, Peter Shirley, and Michael M Stark. 2000. Direct ray tracing of displacement mapped triangles. In </a><span class="s10">Eurographics Workshop on Rendering Techniques</span>. Springer, 307â€“318.</p><p class="s9" style="padding-left: 63pt;text-indent: -9pt;line-height: 84%;text-align: justify;"><a name="bookmark65">LÃ¡szlÃ³ Szirmay-Kalos, TamÃ¡s Umenhoffer, Gustavo Patow, LÃ¡szlÃ³ SzÃ©csi, and Mateu Sbert. 2009. Specular effects on the gpu: State of the art. In </a><span class="s10">Computer Graphics Forum</span>, Vol. 28. Wiley Online Library, 1586â€“1617.</p><p class="s9" style="padding-left: 63pt;text-indent: -9pt;line-height: 84%;text-align: justify;"><a name="bookmark66">Natalya Tatarchuk. 2006. Dynamic parallax occlusion mapping with approximate soft shadows. In </a><span class="s10">Proceedings of the 2006 symposium on Interactive 3D graphics and games</span>. 63â€“69.</p><p class="s9" style="padding-left: 63pt;text-indent: -9pt;line-height: 84%;text-align: justify;"><a name="bookmark67">Art Tevs, Ivo Ihrke, and Hans-Peter Seidel. 2008. Maximum mipmaps for fast, accurate, and scalable dynamic height field rendering. In </a><span class="s10">Proceedings of the 2008 symposium on Interactive 3D graphics and games</span>. 183â€“190.</p><p style="padding-left: 62pt;text-indent: -9pt;line-height: 84%;text-align: justify;"><a href="https://doi.org/10.1145/3478513.3480535" class="s12" target="_blank" name="bookmark68">Theo Thonat, Francois Beaune, Xin Sun, Nathan Carr, and Tamy Boubekeur. 2021. Tessellation-Free Displacement Mapping for Ray Tracing. 40, 6, Article 282 (dec 2021), 16 pages. https://doi.org/10.1145/3478513.3480535</a></p><p class="s9" style="padding-left: 63pt;text-indent: -9pt;line-height: 84%;text-align: justify;"><a name="bookmark69">Ingo Wald, Sven Woop, Carsten Benthin, Gregory S Johnson, and Manfred Ernst. 2014. Embree: a kernel framework for efficient CPU ray tracing. </a><span class="s10">ACM Transactions on Graphics (TOG) </span>33, 4 (2014), 1â€“8.</p><p class="s9" style="padding-left: 62pt;text-indent: -8pt;line-height: 84%;text-align: justify;"><a name="bookmark70">Beibei Wang, MiloÅ¡ HaÅ¡an, Nicolas Holzschuch, and Ling-Qi Yan. 2020. Example-based microstructure rendering with constant storage. </a><span class="s10">ACM Transactions on Graphics (TOG) </span>39, 5 (2020), 1â€“12.</p><p class="s9" style="padding-left: 62pt;text-indent: -8pt;line-height: 84%;text-align: justify;"><a name="bookmark71">Lifeng Wang, Xi Wang, Xin Tong, Stephen Lin, Shimin Hu, Baining Guo, and Heung- Yeung Shum. 2003. View-dependent displacement mapping. </a><span class="s10">ACM Transactions on graphics (TOG) </span>22, 3 (2003), 334â€“339.</p><p class="s9" style="padding-left: 63pt;text-indent: -9pt;line-height: 84%;text-align: justify;"><a name="bookmark72">Xi Wang, Xin Tong, Stephen Lin, Shimin Hu, Baining Guo, and Heung-Yeung Shum. 2004. Generalized displacement maps. In </a><span class="s10">Proceedings of the Fifteenth Eurographics conference on Rendering Techniques</span>. 227â€“233.</p><p class="s9" style="padding-left: 63pt;text-indent: -9pt;line-height: 84%;text-align: justify;"><a name="bookmark73">Keith Yerex and Martin JÃ¤gersand. 2004. Displacement mapping with ray-casting in hardware.. In </a><span class="s10">SIGGRAPH sketches</span>. 149.</p><p class="s9" style="padding-left: 63pt;text-indent: -9pt;line-height: 84%;text-align: justify;">Hao Yuan and Mikhail J Atallah. 2010. Data structures for range minimum queries in multidimensional arrays. In <span class="s10">Proceedings of the twenty-first annual ACM-SIAM symposium on Discrete Algorithms</span>. SIAM, 150â€“160.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 53pt;text-indent: 0pt;text-align: left;"><span><img width="673" height="237" alt="image" src="rmip_files/Image_026.jpg"/></span></p><h3 style="padding-top: 2pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a href="#bookmark67" class="s8" name="bookmark74">Figure 8: Offline renders of scenes from Thonat et al. [2021]</a> that we used in our comparisons; left to right, top to bottom: <i>Alien Sphere</i>, <i>Basket</i>, <i>Diving Helmet</i>, <i>Creature</i>, <i>Medieval Helmet</i>, <i>Elven Armor</i>, <i>Terracotta Roof</i>, and <i>Ninja Head</i>. Base meshes are shown in false color, displacement maps are shown in greyscale.</h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 57pt;text-indent: 0pt;text-align: left;"><span><img width="663" height="154" alt="image" src="rmip_files/Image_027.png"/></span></p><h3 style="padding-top: 2pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a href="#bookmark67" class="s8" name="bookmark75">Figure 9: (a) Rendering of two displaced triangles, shown in false color. (b) Number of traversal steps to reach an intersection for primary rays using the method of Thonat et al. [2021],</a> visualized as a log-scale heat map. The inset reveals the quad-tree nature of their texture-space traversal. (c) Our RMIP traversal requires on average an order of magnitude fewer iterations; for fairness, we additionally count each texel visited during our texel marching as one traversal step. Blocky patterns are visible in the inset, revealing the RMIP resolution.</h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s1" style="padding-left: 53pt;text-indent: 0pt;text-align: left;"><span><img width="331" height="192" alt="image" src="rmip_files/Image_028.png"/></span> <span><img width="334" height="190" alt="image" src="rmip_files/Image_029.png"/></span></p><h3 style="padding-top: 2pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a href="#bookmark67" class="s8" name="bookmark76">Figure 10: Render-time speed-up of our method with respect to TFDM [Thonat et al. 2021]</a> with equivalent memory consumption, when scaling the displacement magnitude (left) and tiling (right) beyond those originally used for each scene. Renderings associated to each displacement parameter change are shown on the sides with the <i>Alien Sphere </i>scene.</h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 62pt;text-indent: 0pt;text-align: left;"><span style=" color: black; font-style: normal; font-weight: normal; text-decoration: none;">	</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="312" height="211" alt="image" src="rmip_files/Image_030.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="90" height="7" alt="image" src="rmip_files/Image_031.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="73" alt="image" src="rmip_files/Image_032.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="312" height="211" alt="image" src="rmip_files/Image_033.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="90" height="7" alt="image" src="rmip_files/Image_034.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="73" alt="image" src="rmip_files/Image_035.png"/></span></p><h3 style="padding-top: 2pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a name="bookmark77">Figure 11: Performance of our method at different texel-marching scales on two scenes (left: </a><i>Elven Armor, GPU </i>; right: <i>Ninja Head, CPU </i><a href="#bookmark67" class="s8">). We show plots for different RMIP resolutions, and also include a setup with our traversal but computing displacement bounds using a minmax mipmap as in TFDM [Thonat et al. 2021].</a> We compare against TFDM as a baseline; it does not support texel marching, hence its flat curve. Render times are relative to the best one achieved by our method (i.e, yellow-curve minimum). The legend includes memory consumption for each data structure relative to the minmax mipmap used by TFDM; for RMIP we also report resolution in pixels. Fastest marching scale for each setup is highlighted with a bold circle.<a name="bookmark78">&zwnj;</a></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 66pt;text-indent: 0pt;text-align: left;"><span><img width="304" height="202" alt="image" src="rmip_files/Image_036.png"/></span>	<span><img width="308" height="202" alt="image" src="rmip_files/Image_037.png"/></span></p><h3 style="padding-top: 3pt;padding-left: 53pt;text-indent: 0pt;line-height: 90%;text-align: justify;"><a name="bookmark79">Figure 12: Benefit of using point-wise displacement inversion on all scenes, for different RMIP resolutions. We show relative render time between inversion enabled and disabled (left: GPU; right: CPU; lower is better).</a></h3></body></html>
